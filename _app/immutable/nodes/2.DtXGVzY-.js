import{b as Sr,d as pa,c as jt,a as N,f as G,e as Xr}from"../chunks/DhaZ0PH4.js";import{b as va,h as ce,a as Yt,K as c,r as ha,c as _a,s as kr,d as Vt,e as It,l as Me,Z as qr,aq as ya,a9 as Rr,f as Ce,j as Or,aN as Te,k as Xt,aO as ba,n as Ta,aF as Ea,aP as xa,ao as er,aQ as Aa,aR as wa,aJ as Sa,W as Dr,aS as ka,g as Kr,p as Jr,aT as Lt,aU as Ra,an as Oa,i as Da,ak as Zr,O as ue,w as Ia,aV as La,ar as Ca,al as Ma,x as ct,Y as Na,aW as Fa,aX as Pa,aY as Ua,aZ as Ha,a_ as za,a$ as Ba,b0 as Ga,aK as Wa,G as ja,V as Ya,b1 as Va,aM as Fe,aL as V,ay as y,ax as Qr,o as Ue,t as qt,u as He,P as E,S as R,Q as x,q as $r,aa as Xa}from"../chunks/B56_dkfp.js";import{d as et,s as se,e as qa}from"../chunks/LqdzY0r8.js";import{i as ie}from"../chunks/iND0BaTL.js";function Ka(e,t,a){for(var n=[],o=t.length,i,f=t.length,l=0;l<o;l++){let v=t[l];Jr(v,()=>{if(i){if(i.pending.delete(v),i.done.add(v),i.pending.size===0){var k=e.outrogroups;Kt(er(i.done)),k.delete(i),k.size===0&&(e.outrogroups=null)}}else f-=1},!1)}if(f===0){var d=n.length===0&&a!==null;if(d){var m=a,b=m.parentNode;Oa(b),b.append(m),e.items.clear()}Kt(t,!d)}else i={pending:new Set(t),done:new Set},(e.outrogroups??(e.outrogroups=new Set)).add(i)}function Kt(e,t=!0){for(var a=0;a<e.length;a++)Da(e[a],t)}var Ir;function ea(e,t,a,n,o,i=null){var f=e,l=new Map;ce&&Yt();var d=null,m=Ea(()=>{var _=a();return xa(_)?_:_==null?[]:er(_)}),b,v=!0;function k(){u.fallback=d,Ja(u,b,f,t,n),d!==null&&(b.length===0?(d.f&Te)===0?Kr(d):(d.f^=Te,Ze(d,null,f)):Jr(d,()=>{d=null}))}var L=va(()=>{b=c(m);var _=b.length;let p=!1;if(ce){var w=ha(f)===_a;w!==(_===0)&&(f=kr(),Vt(f),It(!1),p=!0)}for(var O=new Set,C=Ce,A=Ta(),D=0;D<_;D+=1){ce&&Me.nodeType===qr&&Me.data===ya&&(f=Me,p=!0,It(!1));var H=b[D],K=n(H,D),z=v?null:l.get(K);z?(z.v&&Rr(z.v,H),z.i&&Rr(z.i,D),A&&C.unskip_effect(z.e)):(z=Za(l,v?f:Ir??(Ir=Or()),H,K,D,o,t,a),v||(z.e.f|=Te),l.set(K,z)),O.add(K)}if(_===0&&i&&!d&&(v?d=Xt(()=>i(f)):(d=Xt(()=>i(Ir??(Ir=Or()))),d.f|=Te)),_>O.size&&ba(),ce&&_>0&&Vt(kr()),!v)if(A){for(const[M,Z]of l)O.has(M)||C.skip_effect(Z.e);C.oncommit(k),C.ondiscard(()=>{})}else k();p&&It(!0),c(m)}),u={effect:L,items:l,outrogroups:null,fallback:d};v=!1,ce&&(f=Me)}function We(e){for(;e!==null&&(e.f&Ra)===0;)e=e.next;return e}function Ja(e,t,a,n,o){var z;var i=t.length,f=e.items,l=We(e.effect.first),d,m=null,b=[],v=[],k,L,u,_;for(_=0;_<i;_+=1){if(k=t[_],L=o(k,_),u=f.get(L).e,e.outrogroups!==null)for(const M of e.outrogroups)M.pending.delete(u),M.done.delete(u);if((u.f&Te)!==0)if(u.f^=Te,u===l)Ze(u,null,a);else{var p=m?m.next:l;u===e.effect.last&&(e.effect.last=u.prev),u.prev&&(u.prev.next=u.next),u.next&&(u.next.prev=u.prev),be(e,m,u),be(e,u,p),Ze(u,p,a),m=u,b=[],v=[],l=We(m.next);continue}if((u.f&Lt)!==0&&Kr(u),u!==l){if(d!==void 0&&d.has(u)){if(b.length<v.length){var w=v[0],O;m=w.prev;var C=b[0],A=b[b.length-1];for(O=0;O<b.length;O+=1)Ze(b[O],w,a);for(O=0;O<v.length;O+=1)d.delete(v[O]);be(e,C.prev,A.next),be(e,m,C),be(e,A,w),l=w,m=A,_-=1,b=[],v=[]}else d.delete(u),Ze(u,l,a),be(e,u.prev,u.next),be(e,u,m===null?e.effect.first:m.next),be(e,m,u),m=u;continue}for(b=[],v=[];l!==null&&l!==u;)(d??(d=new Set)).add(l),v.push(l),l=We(l.next);if(l===null)continue}(u.f&Te)===0&&b.push(u),m=u,l=We(u.next)}if(e.outrogroups!==null){for(const M of e.outrogroups)M.pending.size===0&&(Kt(er(M.done)),(z=e.outrogroups)==null||z.delete(M));e.outrogroups.size===0&&(e.outrogroups=null)}if(l!==null||d!==void 0){var D=[];if(d!==void 0)for(u of d)(u.f&Lt)===0&&D.push(u);for(;l!==null;)(l.f&Lt)===0&&l!==e.fallback&&D.push(l),l=We(l.next);var H=D.length;if(H>0){var K=null;Ka(e,D,K)}}}function Za(e,t,a,n,o,i,f,l){var d=(f&Aa)!==0?(f&wa)===0?Sa(a,!1,!1):Dr(a):null,m=(f&ka)!==0?Dr(o):null;return{v:d,i:m,e:Xt(()=>(i(t,d??a,m??o,l),()=>{e.delete(n)}))}}function Ze(e,t,a){if(e.nodes)for(var n=e.nodes.start,o=e.nodes.end,i=t&&(t.f&Te)===0?t.nodes.start:a;n!==null;){var f=Zr(n);if(i.before(n),n===o)return;n=f}}function be(e,t,a){t===null?e.effect.first=a:t.next=a,a===null?e.effect.last=t:a.prev=t}function Qa(e,t,a=!1,n=!1,o=!1){var i=e,f="";ue(()=>{var l=Ia;if(f===(f=t()??"")){ce&&Yt();return}if(l.nodes!==null&&(La(l.nodes.start,l.nodes.end),l.nodes=null),f!==""){if(ce){Me.data;for(var d=Yt(),m=d;d!==null&&(d.nodeType!==qr||d.data!=="");)m=d,d=Zr(d);if(d===null)throw Ca(),Ma;Sr(Me,m),i=Vt(d);return}var b=f+"";a?b=`<svg>${b}</svg>`:n&&(b=`<math>${b}</math>`);var v=pa(b);if((a||n)&&(v=ct(v)),Sr(ct(v),v.lastChild),a||n)for(;ct(v);)i.before(ct(v));else i.before(v)}})}function $a(e,t,a){var n=e==null?"":""+e;return n===""?null:n}function Ee(e,t,a,n,o,i){var f=e.__className;if(ce||f!==a||f===void 0){var l=$a(a);(!ce||l!==e.getAttribute("class"))&&(l==null?e.removeAttribute("class"):e.className=l),e.__className=a}return i}const en=Symbol("is custom element"),tn=Symbol("is html"),rn=Ha?"link":"LINK";function Lr(e){if(ce){var t=!1,a=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var n=e.value;Jt(e,"value",null),e.value=n}if(e.hasAttribute("checked")){var o=e.checked;Jt(e,"checked",null),e.checked=o}}};e.__on_r=a,Na(a),Fa()}}function Jt(e,t,a,n){var o=an(e);ce&&(o[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName===rn)||o[t]!==(o[t]=a)&&(t==="loading"&&(e[Pa]=a),a==null?e.removeAttribute(t):typeof a!="string"&&nn(e).includes(t)?e[t]=a:e.setAttribute(t,a))}function an(e){return e.__attributes??(e.__attributes={[en]:e.nodeName.includes("-"),[tn]:e.namespaceURI===Ua})}var Cr=new Map;function nn(e){var t=e.getAttribute("is")||e.nodeName,a=Cr.get(t);if(a)return a;Cr.set(t,a=[]);for(var n,o=e,i=Element.prototype;i!==o;){n=Ba(o);for(var f in n)n[f].set&&a.push(f);o=za(o)}return a}function Mr(e,t,a=t){var n=new WeakSet;Ga(e,"input",async o=>{var i=o?e.defaultValue:e.value;if(i=Ct(e)?Mt(i):i,a(i),Ce!==null&&n.add(Ce),await Wa(),i!==(i=t())){var f=e.selectionStart,l=e.selectionEnd,d=e.value.length;if(e.value=i??"",l!==null){var m=e.value.length;f===l&&l===d&&m>d?(e.selectionStart=m,e.selectionEnd=m):(e.selectionStart=f,e.selectionEnd=Math.min(l,m))}}}),(ce&&e.defaultValue!==e.value||ja(t)==null&&e.value)&&(a(Ct(e)?Mt(e.value):e.value),Ce!==null&&n.add(Ce)),Ya(()=>{var o=t();if(e===document.activeElement){var i=Va??Ce;if(n.has(i))return}Ct(e)&&o===Mt(e.value)||e.type==="date"&&!o&&!e.value||o!==e.value&&(e.value=o??"")})}function Ct(e){var t=e.type;return t==="number"||t==="range"}function Mt(e){return e===""?null:+e}let Ne=V(null);const Nr=Fe(()=>{var e;return c(Ne)!==null&&Date.now()<(((e=c(Ne))==null?void 0:e.expiresAt)??0)}),oe={get tokens(){return c(Ne)},get isSignedIn(){return c(Nr)},get accessToken(){return c(Nr)?c(Ne).accessToken:null},signIn(){{console.error("VITE_GOOGLE_CLIENT_ID not set");return}},signOut(){y(Ne,null)},handleRedirect(){const e=window.location.hash;if(!e.includes("access_token"))return!1;const t=new URLSearchParams(e.slice(1)),a=t.get("access_token"),n=t.get("expires_in");return a&&n?(y(Ne,{accessToken:a,expiresAt:Date.now()+parseInt(n)*1e3},!0),window.history.replaceState(null,"",window.location.pathname),!0):!1}},vt="https://www.googleapis.com/drive/v3",Fr="https://www.googleapis.com/upload/drive/v3",Pr="readly",gt="application/json";function Pe(e){return{Authorization:`Bearer ${e}`}}async function ht(e){const t=`name='${Pr}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,a=`${vt}/files?q=${encodeURIComponent(t)}&fields=files(id,name)`,n=await fetch(a,{headers:Pe(e)});if(!n.ok)throw new Error(`Drive search failed: ${n.status}`);const o=await n.json();if(o.files.length>0)return o.files[0].id;const i=await fetch(`${vt}/files`,{method:"POST",headers:{...Pe(e),"Content-Type":gt},body:JSON.stringify({name:Pr,mimeType:"application/vnd.google-apps.folder"})});if(!i.ok)throw new Error(`Drive folder creation failed: ${i.status}`);return(await i.json()).id}async function tr(e,t,a){const n=`name='${a}' and '${t}' in parents and trashed=false`,o=`${vt}/files?q=${encodeURIComponent(n)}&fields=files(id)`,i=await fetch(o,{headers:Pe(e)});if(!i.ok)throw new Error(`Drive file search failed: ${i.status}`);const f=await i.json();return f.files.length>0?f.files[0].id:null}async function ta(e,t){const a=`${vt}/files/${t}?alt=media`,n=await fetch(a,{headers:Pe(e)});if(!n.ok)throw new Error(`Drive read failed: ${n.status}`);return await n.json()}async function _t(e,t,a,n){const o=await tr(e,t,a),i=JSON.stringify(n);if(o){const k=`${Fr}/files/${o}?uploadType=media`,L=await fetch(k,{method:"PATCH",headers:{...Pe(e),"Content-Type":gt},body:i});if(!L.ok)throw new Error(`Drive update failed: ${L.status}`);return o}const f=JSON.stringify({name:a,parents:[t]}),l="feedle_boundary",d=`--${l}\r
Content-Type: ${gt}\r
\r
${f}\r
--${l}\r
Content-Type: ${gt}\r
\r
${i}\r
--${l}--`,m=`${Fr}/files?uploadType=multipart`,b=await fetch(m,{method:"POST",headers:{...Pe(e),"Content-Type":`multipart/related; boundary=${l}`},body:d});if(!b.ok)throw new Error(`Drive create failed: ${b.status}`);return(await b.json()).id}async function on(e){const t=await ht(e),a=await tr(e,t,"config.json");if(!a){const n={feeds:[],folders:[],preferences:{refreshInterval:30,theme:"system",defaultView:"unread"}};return await _t(e,t,"config.json",n),n}return ta(e,a)}async function Ur(e,t){const a=await ht(e);await _t(e,a,"config.json",t)}async function sn(e){const t=await ht(e),a=await tr(e,t,"state.json");if(!a){const n={read:[],saved:[],lastSync:new Date().toISOString()};return await _t(e,t,"state.json",n),n}return ta(e,a)}async function ln(e,t){const a=await ht(e);await _t(e,a,"state.json",t)}let ne=V(Qr({feeds:[],folders:[],preferences:{refreshInterval:30,theme:"system",defaultView:"unread"}})),Nt=V(!1);const Qe={get config(){return c(ne)},get feeds(){return c(ne).feeds},get syncing(){return c(Nt)},async loadFromDrive(e){y(Nt,!0);try{y(ne,await on(e),!0)}catch(t){console.error("Failed to load config from Drive:",t)}finally{y(Nt,!1)}},async addFeed(e,t,a){if(c(ne).feeds.some(o=>o.url===e))return;const n={url:e,title:t,folder:"",added:new Date().toISOString()};if(y(ne,{...c(ne),feeds:[...c(ne).feeds,n]},!0),a)try{await Ur(a,c(ne))}catch(o){console.error("Failed to save config to Drive:",o)}},async removeFeed(e,t){if(y(ne,{...c(ne),feeds:c(ne).feeds.filter(a=>a.url!==e)},!0),t)try{await Ur(t,c(ne))}catch(a){console.error("Failed to save config to Drive:",a)}},setFeeds(e){y(ne,{...c(ne),feeds:e},!0)}};let je=V(null),Ye=V("idle"),dt=V(null);const we={get bundle(){return c(je)},get loadingState(){return c(Ye)},get error(){return c(dt)},get feeds(){return c(je)?Object.values(c(je).feeds):[]},get allEntries(){return this.feeds.flatMap(e=>e.entries).sort((e,t)=>new Date(t.published).getTime()-new Date(e.published).getTime())},async loadBundle(e="/feed-bundle.json"){y(Ye,"loading"),y(dt,null);try{let t=await fetch(e);if(t.ok,!t.ok)throw new Error(`Failed to fetch bundle: ${t.status}`);y(je,await t.json(),!0),y(Ye,"success")}catch(t){y(dt,t instanceof Error?t.message:"Unknown error",!0),y(Ye,"error")}},setBundle(e){y(je,e,!0),y(Ye,"success"),y(dt,null)}};let $=V(Qr({read:[],saved:[],lastSync:new Date().toISOString()})),$e=V(!1),Ft=null;function Pt(e){Ft&&clearTimeout(Ft),Ft=setTimeout(async()=>{y($e,!0);try{await ln(e,c($))}catch(t){console.error("Failed to sync state to Drive:",t)}finally{y($e,!1)}},1e3)}const ve={get state(){return c($)},get syncing(){return c($e)},isRead(e){return c($).read.includes(e)},isSaved(e){return c($).saved.includes(e)},markRead(e,t){c($).read.includes(e)||(c($).read=[...c($).read,e],t&&Pt(t))},markUnread(e,t){c($).read=c($).read.filter(a=>a!==e),t&&Pt(t)},toggleSaved(e,t){c($).saved.includes(e)?c($).saved=c($).saved.filter(a=>a!==e):c($).saved=[...c($).saved,e],t&&Pt(t)},async loadFromDrive(e){y($e,!0);try{y($,await sn(e),!0)}catch(t){console.error("Failed to load state from Drive:",t)}finally{y($e,!1)}}};var cn=G('<p class="mb-3 text-sm text-red-600 dark:text-red-400"> </p>'),dn=G('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50" role="dialog" aria-modal="true" tabindex="-1"><div class="mx-4 w-full max-w-md rounded-lg bg-white p-6 shadow-xl dark:bg-gray-800"><h2 class="mb-4 text-lg font-semibold text-gray-900 dark:text-white">Add Feed</h2> <form><div class="mb-3"><label for="feed-url" class="mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300">Feed URL</label> <input id="feed-url" type="url" placeholder="https://example.com/feed.xml" class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white" required=""/></div> <div class="mb-4"><label for="feed-title" class="mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300">Title (optional)</label> <input id="feed-title" type="text" placeholder="My Favorite Blog" class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"/></div> <!> <div class="flex justify-end gap-2"><button type="button" class="rounded-md px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700">Cancel</button> <button type="submit" class="rounded-md bg-indigo-600 px-4 py-2 text-sm text-white hover:bg-indigo-700 disabled:opacity-50"> </button></div></form></div></div>');function fn(e,t){Ue(t,!0);let a=V(""),n=V(""),o=V(!1),i=V("");async function f(){if(!c(a).trim()){y(i,"Please enter a feed URL");return}y(o,!0),y(i,"");try{const v=c(n).trim()||new URL(c(a)).hostname;await Qe.addFeed(c(a).trim(),v,oe.accessToken),y(a,""),y(n,""),t.onClose()}catch(v){y(i,v instanceof Error?v.message:"Failed to add feed",!0)}finally{y(o,!1)}}function l(v){v.key==="Escape"&&t.onClose()}var d=jt(),m=qt(d);{var b=v=>{var k=dn();k.__keydown=l;var L=E(k),u=R(E(L),2),_=E(u),p=R(E(_),2);Lr(p),x(_);var w=R(_,2),O=R(E(w),2);Lr(O),x(w);var C=R(w,2);{var A=M=>{var Z=cn(),T=E(Z,!0);x(Z),ue(()=>se(T,c(i))),N(M,Z)};ie(C,M=>{c(i)&&M(A)})}var D=R(C,2),H=E(D);H.__click=function(...M){var Z;(Z=t.onClose)==null||Z.apply(this,M)};var K=R(H,2),z=E(K,!0);x(K),x(D),x(u),x(L),x(k),ue(()=>{K.disabled=c(o),se(z,c(o)?"Adding...":"Add Feed")}),qa("submit",u,M=>{M.preventDefault(),f()}),Mr(p,()=>c(a),M=>y(a,M)),Mr(O,()=>c(n),M=>y(n,M)),N(v,k)};ie(m,v=>{t.open&&v(b)})}N(e,d),He()}et(["keydown","click"]);var un=G('<span class="text-amber-500">Saved</span>'),mn=G('<button><h3> </h3> <p class="mt-0.5 line-clamp-2 text-xs text-gray-500 dark:text-gray-400"> </p> <div class="mt-1 flex items-center gap-2 text-xs text-gray-400 dark:text-gray-500"><span> </span> <!></div></button>'),gn=G('<div class="flex flex-1 items-center justify-center p-8"><p class="text-sm text-gray-400 dark:text-gray-500">No entries to show.</p></div>'),pn=G('<div class="flex h-full flex-col overflow-y-auto border-r border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-950"><!> <!></div>');function vn(e,t){Ue(t,!0);function a(l){const d=new Date(l),b=new Date().getTime()-d.getTime(),v=Math.floor(b/36e5);if(v<1)return"Just now";if(v<24)return`${v}h ago`;const k=Math.floor(v/24);return k<7?`${k}d ago`:d.toLocaleDateString()}var n=pn(),o=E(n);ea(o,17,()=>t.entries,l=>l.id,(l,d)=>{var m=mn();m.__click=()=>t.onSelectEntry(c(d));var b=E(m),v=E(b,!0);x(b);var k=R(b,2),L=E(k,!0);x(k);var u=R(k,2),_=E(u),p=E(_,!0);x(_);var w=R(_,2);{var O=A=>{var D=un();N(A,D)},C=Fe(()=>ve.isSaved(c(d).id));ie(w,A=>{c(C)&&A(O)})}x(u),x(m),ue((A,D,H)=>{Ee(m,1,`border-b border-gray-100 px-4 py-3 text-left transition-colors dark:border-gray-800
				${t.selectedEntryId===c(d).id?"bg-indigo-50 dark:bg-indigo-950":"hover:bg-gray-50 dark:hover:bg-gray-900"}
				${A??""}`),Ee(b,1,`text-sm font-medium text-gray-900 dark:text-gray-100 ${D??""}`),se(v,c(d).title),se(L,c(d).summary),se(p,H)},[()=>ve.isRead(c(d).id)?"opacity-60":"",()=>ve.isRead(c(d).id)?"font-normal":"",()=>a(c(d).published)]),N(l,m)});var i=R(o,2);{var f=l=>{var d=gn();N(l,d)};ie(i,l=>{t.entries.length===0&&l(f)})}x(n),N(e,n),He()}et(["click"]);/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:ra,setPrototypeOf:Hr,isFrozen:hn,getPrototypeOf:_n,getOwnPropertyDescriptor:yn}=Object;let{freeze:ee,seal:de,create:Zt}=Object,{apply:Qt,construct:$t}=typeof Reflect<"u"&&Reflect;ee||(ee=function(t){return t});de||(de=function(t){return t});Qt||(Qt=function(t,a){for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];return t.apply(a,o)});$t||($t=function(t){for(var a=arguments.length,n=new Array(a>1?a-1:0),o=1;o<a;o++)n[o-1]=arguments[o];return new t(...n)});const ft=te(Array.prototype.forEach),bn=te(Array.prototype.lastIndexOf),zr=te(Array.prototype.pop),Ve=te(Array.prototype.push),Tn=te(Array.prototype.splice),pt=te(String.prototype.toLowerCase),Ut=te(String.prototype.toString),Ht=te(String.prototype.match),Xe=te(String.prototype.replace),En=te(String.prototype.indexOf),xn=te(String.prototype.trim),fe=te(Object.prototype.hasOwnProperty),Q=te(RegExp.prototype.test),qe=An(TypeError);function te(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var a=arguments.length,n=new Array(a>1?a-1:0),o=1;o<a;o++)n[o-1]=arguments[o];return Qt(e,t,n)}}function An(e){return function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return $t(e,a)}}function S(e,t){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:pt;Hr&&Hr(e,null);let n=t.length;for(;n--;){let o=t[n];if(typeof o=="string"){const i=a(o);i!==o&&(hn(t)||(t[n]=i),o=i)}e[o]=!0}return e}function wn(e){for(let t=0;t<e.length;t++)fe(e,t)||(e[t]=null);return e}function pe(e){const t=Zt(null);for(const[a,n]of ra(e))fe(e,a)&&(Array.isArray(n)?t[a]=wn(n):n&&typeof n=="object"&&n.constructor===Object?t[a]=pe(n):t[a]=n);return t}function Ke(e,t){for(;e!==null;){const n=yn(e,t);if(n){if(n.get)return te(n.get);if(typeof n.value=="function")return te(n.value)}e=_n(e)}function a(){return null}return a}const Br=ee(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),zt=ee(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Bt=ee(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Sn=ee(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Gt=ee(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),kn=ee(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Gr=ee(["#text"]),Wr=ee(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Wt=ee(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),jr=ee(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ut=ee(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Rn=de(/\{\{[\w\W]*|[\w\W]*\}\}/gm),On=de(/<%[\w\W]*|[\w\W]*%>/gm),Dn=de(/\$\{[\w\W]*/gm),In=de(/^data-[\-\w.\u00B7-\uFFFF]+$/),Ln=de(/^aria-[\-\w]+$/),aa=de(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Cn=de(/^(?:\w+script|data):/i),Mn=de(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),na=de(/^html$/i),Nn=de(/^[a-z][.\w]*(-[.\w]+)+$/i);var Yr=Object.freeze({__proto__:null,ARIA_ATTR:Ln,ATTR_WHITESPACE:Mn,CUSTOM_ELEMENT:Nn,DATA_ATTR:In,DOCTYPE_NAME:na,ERB_EXPR:On,IS_ALLOWED_URI:aa,IS_SCRIPT_OR_DATA:Cn,MUSTACHE_EXPR:Rn,TMPLIT_EXPR:Dn});const Je={element:1,text:3,progressingInstruction:7,comment:8,document:9},Fn=function(){return typeof window>"u"?null:window},Pn=function(t,a){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let n=null;const o="data-tt-policy-suffix";a&&a.hasAttribute(o)&&(n=a.getAttribute(o));const i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML(f){return f},createScriptURL(f){return f}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},Vr=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function oa(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fn();const t=h=>oa(h);if(t.version="3.3.1",t.removed=[],!e||!e.document||e.document.nodeType!==Je.document||!e.Element)return t.isSupported=!1,t;let{document:a}=e;const n=a,o=n.currentScript,{DocumentFragment:i,HTMLTemplateElement:f,Node:l,Element:d,NodeFilter:m,NamedNodeMap:b=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:v,DOMParser:k,trustedTypes:L}=e,u=d.prototype,_=Ke(u,"cloneNode"),p=Ke(u,"remove"),w=Ke(u,"nextSibling"),O=Ke(u,"childNodes"),C=Ke(u,"parentNode");if(typeof f=="function"){const h=a.createElement("template");h.content&&h.content.ownerDocument&&(a=h.content.ownerDocument)}let A,D="";const{implementation:H,createNodeIterator:K,createDocumentFragment:z,getElementsByTagName:M}=a,{importNode:Z}=n;let T=Vr();t.isSupported=typeof ra=="function"&&typeof C=="function"&&H&&H.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:U,ERB_EXPR:le,TMPLIT_EXPR:I,DATA_ATTR:P,ARIA_ATTR:re,IS_SCRIPT_OR_DATA:tt,ATTR_WHITESPACE:rr,CUSTOM_ELEMENT:ia}=Yr;let{IS_ALLOWED_URI:ar}=Yr,Y=null;const nr=S({},[...Br,...zt,...Bt,...Gt,...Gr]);let X=null;const or=S({},[...Wr,...Wt,...jr,...ut]);let B=Object.seal(Zt(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ze=null,yt=null;const Se=Object.seal(Zt(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let ir=!0,bt=!0,sr=!1,lr=!0,ke=!1,rt=!0,xe=!1,Tt=!1,Et=!1,Re=!1,at=!1,nt=!1,cr=!0,dr=!1;const sa="user-content-";let xt=!0,Be=!1,Oe={},me=null;const At=S({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let fr=null;const ur=S({},["audio","video","img","source","image","track"]);let wt=null;const mr=S({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ot="http://www.w3.org/1998/Math/MathML",it="http://www.w3.org/2000/svg",he="http://www.w3.org/1999/xhtml";let De=he,St=!1,kt=null;const la=S({},[ot,it,he],Ut);let st=S({},["mi","mo","mn","ms","mtext"]),lt=S({},["annotation-xml"]);const ca=S({},["title","style","font","a","script"]);let Ge=null;const da=["application/xhtml+xml","text/html"],fa="text/html";let j=null,Ie=null;const ua=a.createElement("form"),gr=function(r){return r instanceof RegExp||r instanceof Function},Rt=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ie&&Ie===r)){if((!r||typeof r!="object")&&(r={}),r=pe(r),Ge=da.indexOf(r.PARSER_MEDIA_TYPE)===-1?fa:r.PARSER_MEDIA_TYPE,j=Ge==="application/xhtml+xml"?Ut:pt,Y=fe(r,"ALLOWED_TAGS")?S({},r.ALLOWED_TAGS,j):nr,X=fe(r,"ALLOWED_ATTR")?S({},r.ALLOWED_ATTR,j):or,kt=fe(r,"ALLOWED_NAMESPACES")?S({},r.ALLOWED_NAMESPACES,Ut):la,wt=fe(r,"ADD_URI_SAFE_ATTR")?S(pe(mr),r.ADD_URI_SAFE_ATTR,j):mr,fr=fe(r,"ADD_DATA_URI_TAGS")?S(pe(ur),r.ADD_DATA_URI_TAGS,j):ur,me=fe(r,"FORBID_CONTENTS")?S({},r.FORBID_CONTENTS,j):At,ze=fe(r,"FORBID_TAGS")?S({},r.FORBID_TAGS,j):pe({}),yt=fe(r,"FORBID_ATTR")?S({},r.FORBID_ATTR,j):pe({}),Oe=fe(r,"USE_PROFILES")?r.USE_PROFILES:!1,ir=r.ALLOW_ARIA_ATTR!==!1,bt=r.ALLOW_DATA_ATTR!==!1,sr=r.ALLOW_UNKNOWN_PROTOCOLS||!1,lr=r.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ke=r.SAFE_FOR_TEMPLATES||!1,rt=r.SAFE_FOR_XML!==!1,xe=r.WHOLE_DOCUMENT||!1,Re=r.RETURN_DOM||!1,at=r.RETURN_DOM_FRAGMENT||!1,nt=r.RETURN_TRUSTED_TYPE||!1,Et=r.FORCE_BODY||!1,cr=r.SANITIZE_DOM!==!1,dr=r.SANITIZE_NAMED_PROPS||!1,xt=r.KEEP_CONTENT!==!1,Be=r.IN_PLACE||!1,ar=r.ALLOWED_URI_REGEXP||aa,De=r.NAMESPACE||he,st=r.MATHML_TEXT_INTEGRATION_POINTS||st,lt=r.HTML_INTEGRATION_POINTS||lt,B=r.CUSTOM_ELEMENT_HANDLING||{},r.CUSTOM_ELEMENT_HANDLING&&gr(r.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(B.tagNameCheck=r.CUSTOM_ELEMENT_HANDLING.tagNameCheck),r.CUSTOM_ELEMENT_HANDLING&&gr(r.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(B.attributeNameCheck=r.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),r.CUSTOM_ELEMENT_HANDLING&&typeof r.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(B.allowCustomizedBuiltInElements=r.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ke&&(bt=!1),at&&(Re=!0),Oe&&(Y=S({},Gr),X=[],Oe.html===!0&&(S(Y,Br),S(X,Wr)),Oe.svg===!0&&(S(Y,zt),S(X,Wt),S(X,ut)),Oe.svgFilters===!0&&(S(Y,Bt),S(X,Wt),S(X,ut)),Oe.mathMl===!0&&(S(Y,Gt),S(X,jr),S(X,ut))),r.ADD_TAGS&&(typeof r.ADD_TAGS=="function"?Se.tagCheck=r.ADD_TAGS:(Y===nr&&(Y=pe(Y)),S(Y,r.ADD_TAGS,j))),r.ADD_ATTR&&(typeof r.ADD_ATTR=="function"?Se.attributeCheck=r.ADD_ATTR:(X===or&&(X=pe(X)),S(X,r.ADD_ATTR,j))),r.ADD_URI_SAFE_ATTR&&S(wt,r.ADD_URI_SAFE_ATTR,j),r.FORBID_CONTENTS&&(me===At&&(me=pe(me)),S(me,r.FORBID_CONTENTS,j)),r.ADD_FORBID_CONTENTS&&(me===At&&(me=pe(me)),S(me,r.ADD_FORBID_CONTENTS,j)),xt&&(Y["#text"]=!0),xe&&S(Y,["html","head","body"]),Y.table&&(S(Y,["tbody"]),delete ze.tbody),r.TRUSTED_TYPES_POLICY){if(typeof r.TRUSTED_TYPES_POLICY.createHTML!="function")throw qe('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof r.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw qe('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');A=r.TRUSTED_TYPES_POLICY,D=A.createHTML("")}else A===void 0&&(A=Pn(L,o)),A!==null&&typeof D=="string"&&(D=A.createHTML(""));ee&&ee(r),Ie=r}},pr=S({},[...zt,...Bt,...Sn]),vr=S({},[...Gt,...kn]),ma=function(r){let s=C(r);(!s||!s.tagName)&&(s={namespaceURI:De,tagName:"template"});const g=pt(r.tagName),F=pt(s.tagName);return kt[r.namespaceURI]?r.namespaceURI===it?s.namespaceURI===he?g==="svg":s.namespaceURI===ot?g==="svg"&&(F==="annotation-xml"||st[F]):!!pr[g]:r.namespaceURI===ot?s.namespaceURI===he?g==="math":s.namespaceURI===it?g==="math"&&lt[F]:!!vr[g]:r.namespaceURI===he?s.namespaceURI===it&&!lt[F]||s.namespaceURI===ot&&!st[F]?!1:!vr[g]&&(ca[g]||!pr[g]):!!(Ge==="application/xhtml+xml"&&kt[r.namespaceURI]):!1},ge=function(r){Ve(t.removed,{element:r});try{C(r).removeChild(r)}catch{p(r)}},Ae=function(r,s){try{Ve(t.removed,{attribute:s.getAttributeNode(r),from:s})}catch{Ve(t.removed,{attribute:null,from:s})}if(s.removeAttribute(r),r==="is")if(Re||at)try{ge(s)}catch{}else try{s.setAttribute(r,"")}catch{}},hr=function(r){let s=null,g=null;if(Et)r="<remove></remove>"+r;else{const W=Ht(r,/^[\r\n\t ]+/);g=W&&W[0]}Ge==="application/xhtml+xml"&&De===he&&(r='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+r+"</body></html>");const F=A?A.createHTML(r):r;if(De===he)try{s=new k().parseFromString(F,Ge)}catch{}if(!s||!s.documentElement){s=H.createDocument(De,"template",null);try{s.documentElement.innerHTML=St?D:F}catch{}}const J=s.body||s.documentElement;return r&&g&&J.insertBefore(a.createTextNode(g),J.childNodes[0]||null),De===he?M.call(s,xe?"html":"body")[0]:xe?s.documentElement:J},_r=function(r){return K.call(r.ownerDocument||r,r,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT|m.SHOW_PROCESSING_INSTRUCTION|m.SHOW_CDATA_SECTION,null)},Ot=function(r){return r instanceof v&&(typeof r.nodeName!="string"||typeof r.textContent!="string"||typeof r.removeChild!="function"||!(r.attributes instanceof b)||typeof r.removeAttribute!="function"||typeof r.setAttribute!="function"||typeof r.namespaceURI!="string"||typeof r.insertBefore!="function"||typeof r.hasChildNodes!="function")},yr=function(r){return typeof l=="function"&&r instanceof l};function _e(h,r,s){ft(h,g=>{g.call(t,r,s,Ie)})}const br=function(r){let s=null;if(_e(T.beforeSanitizeElements,r,null),Ot(r))return ge(r),!0;const g=j(r.nodeName);if(_e(T.uponSanitizeElement,r,{tagName:g,allowedTags:Y}),rt&&r.hasChildNodes()&&!yr(r.firstElementChild)&&Q(/<[/\w!]/g,r.innerHTML)&&Q(/<[/\w!]/g,r.textContent)||r.nodeType===Je.progressingInstruction||rt&&r.nodeType===Je.comment&&Q(/<[/\w]/g,r.data))return ge(r),!0;if(!(Se.tagCheck instanceof Function&&Se.tagCheck(g))&&(!Y[g]||ze[g])){if(!ze[g]&&Er(g)&&(B.tagNameCheck instanceof RegExp&&Q(B.tagNameCheck,g)||B.tagNameCheck instanceof Function&&B.tagNameCheck(g)))return!1;if(xt&&!me[g]){const F=C(r)||r.parentNode,J=O(r)||r.childNodes;if(J&&F){const W=J.length;for(let ae=W-1;ae>=0;--ae){const ye=_(J[ae],!0);ye.__removalCount=(r.__removalCount||0)+1,F.insertBefore(ye,w(r))}}}return ge(r),!0}return r instanceof d&&!ma(r)||(g==="noscript"||g==="noembed"||g==="noframes")&&Q(/<\/no(script|embed|frames)/i,r.innerHTML)?(ge(r),!0):(ke&&r.nodeType===Je.text&&(s=r.textContent,ft([U,le,I],F=>{s=Xe(s,F," ")}),r.textContent!==s&&(Ve(t.removed,{element:r.cloneNode()}),r.textContent=s)),_e(T.afterSanitizeElements,r,null),!1)},Tr=function(r,s,g){if(cr&&(s==="id"||s==="name")&&(g in a||g in ua))return!1;if(!(bt&&!yt[s]&&Q(P,s))){if(!(ir&&Q(re,s))){if(!(Se.attributeCheck instanceof Function&&Se.attributeCheck(s,r))){if(!X[s]||yt[s]){if(!(Er(r)&&(B.tagNameCheck instanceof RegExp&&Q(B.tagNameCheck,r)||B.tagNameCheck instanceof Function&&B.tagNameCheck(r))&&(B.attributeNameCheck instanceof RegExp&&Q(B.attributeNameCheck,s)||B.attributeNameCheck instanceof Function&&B.attributeNameCheck(s,r))||s==="is"&&B.allowCustomizedBuiltInElements&&(B.tagNameCheck instanceof RegExp&&Q(B.tagNameCheck,g)||B.tagNameCheck instanceof Function&&B.tagNameCheck(g))))return!1}else if(!wt[s]){if(!Q(ar,Xe(g,rr,""))){if(!((s==="src"||s==="xlink:href"||s==="href")&&r!=="script"&&En(g,"data:")===0&&fr[r])){if(!(sr&&!Q(tt,Xe(g,rr,"")))){if(g)return!1}}}}}}}return!0},Er=function(r){return r!=="annotation-xml"&&Ht(r,ia)},xr=function(r){_e(T.beforeSanitizeAttributes,r,null);const{attributes:s}=r;if(!s||Ot(r))return;const g={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:X,forceKeepAttr:void 0};let F=s.length;for(;F--;){const J=s[F],{name:W,namespaceURI:ae,value:ye}=J,Le=j(W),Dt=ye;let q=W==="value"?Dt:xn(Dt);if(g.attrName=Le,g.attrValue=q,g.keepAttr=!0,g.forceKeepAttr=void 0,_e(T.uponSanitizeAttribute,r,g),q=g.attrValue,dr&&(Le==="id"||Le==="name")&&(Ae(W,r),q=sa+q),rt&&Q(/((--!?|])>)|<\/(style|title|textarea)/i,q)){Ae(W,r);continue}if(Le==="attributename"&&Ht(q,"href")){Ae(W,r);continue}if(g.forceKeepAttr)continue;if(!g.keepAttr){Ae(W,r);continue}if(!lr&&Q(/\/>/i,q)){Ae(W,r);continue}ke&&ft([U,le,I],wr=>{q=Xe(q,wr," ")});const Ar=j(r.nodeName);if(!Tr(Ar,Le,q)){Ae(W,r);continue}if(A&&typeof L=="object"&&typeof L.getAttributeType=="function"&&!ae)switch(L.getAttributeType(Ar,Le)){case"TrustedHTML":{q=A.createHTML(q);break}case"TrustedScriptURL":{q=A.createScriptURL(q);break}}if(q!==Dt)try{ae?r.setAttributeNS(ae,W,q):r.setAttribute(W,q),Ot(r)?ge(r):zr(t.removed)}catch{Ae(W,r)}}_e(T.afterSanitizeAttributes,r,null)},ga=function h(r){let s=null;const g=_r(r);for(_e(T.beforeSanitizeShadowDOM,r,null);s=g.nextNode();)_e(T.uponSanitizeShadowNode,s,null),br(s),xr(s),s.content instanceof i&&h(s.content);_e(T.afterSanitizeShadowDOM,r,null)};return t.sanitize=function(h){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=null,g=null,F=null,J=null;if(St=!h,St&&(h="<!-->"),typeof h!="string"&&!yr(h))if(typeof h.toString=="function"){if(h=h.toString(),typeof h!="string")throw qe("dirty is not a string, aborting")}else throw qe("toString is not a function");if(!t.isSupported)return h;if(Tt||Rt(r),t.removed=[],typeof h=="string"&&(Be=!1),Be){if(h.nodeName){const ye=j(h.nodeName);if(!Y[ye]||ze[ye])throw qe("root node is forbidden and cannot be sanitized in-place")}}else if(h instanceof l)s=hr("<!---->"),g=s.ownerDocument.importNode(h,!0),g.nodeType===Je.element&&g.nodeName==="BODY"||g.nodeName==="HTML"?s=g:s.appendChild(g);else{if(!Re&&!ke&&!xe&&h.indexOf("<")===-1)return A&&nt?A.createHTML(h):h;if(s=hr(h),!s)return Re?null:nt?D:""}s&&Et&&ge(s.firstChild);const W=_r(Be?h:s);for(;F=W.nextNode();)br(F),xr(F),F.content instanceof i&&ga(F.content);if(Be)return h;if(Re){if(at)for(J=z.call(s.ownerDocument);s.firstChild;)J.appendChild(s.firstChild);else J=s;return(X.shadowroot||X.shadowrootmode)&&(J=Z.call(n,J,!0)),J}let ae=xe?s.outerHTML:s.innerHTML;return xe&&Y["!doctype"]&&s.ownerDocument&&s.ownerDocument.doctype&&s.ownerDocument.doctype.name&&Q(na,s.ownerDocument.doctype.name)&&(ae="<!DOCTYPE "+s.ownerDocument.doctype.name+`>
`+ae),ke&&ft([U,le,I],ye=>{ae=Xe(ae,ye," ")}),A&&nt?A.createHTML(ae):ae},t.setConfig=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Rt(h),Tt=!0},t.clearConfig=function(){Ie=null,Tt=!1},t.isValidAttribute=function(h,r,s){Ie||Rt({});const g=j(h),F=j(r);return Tr(g,F,s)},t.addHook=function(h,r){typeof r=="function"&&Ve(T[h],r)},t.removeHook=function(h,r){if(r!==void 0){const s=bn(T[h],r);return s===-1?void 0:Tn(T[h],s,1)[0]}return zr(T[h])},t.removeHooks=function(h){T[h]=[]},t.removeAllHooks=function(){T=Vr()},t}var Un=oa(),Hn=G('<button class="mb-3 flex items-center gap-1 text-sm text-gray-500 hover:text-gray-700 lg:hidden dark:text-gray-400 dark:hover:text-gray-200"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg> Back</button>'),zn=G("<span> </span>"),Bn=G('<button class="rounded-md bg-gray-100 px-3 py-1 text-xs text-gray-600 dark:bg-gray-800 dark:text-gray-400">Mark unread</button>'),Gn=G("<p> </p>"),Wn=G('<article class="h-full overflow-y-auto p-6"><header class="mb-4"><!> <h2 class="text-2xl font-bold text-gray-900 dark:text-white"> </h2> <div class="mt-2 flex items-center gap-3 text-sm text-gray-500 dark:text-gray-400"><!> <span> </span> <a target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline dark:text-indigo-400">Open original</a></div> <div class="mt-3 flex gap-2"><button> </button> <!></div></header> <div class="prose prose-sm max-w-none dark:prose-invert"><!></div></article>'),jn=G('<div class="flex h-full items-center justify-center"><p class="text-gray-400 dark:text-gray-500">Select an entry to read.</p></div>');function Yn(e,t){Ue(t,!0);let a=Fe(()=>{var l;return(l=t.entry)!=null&&l.content?Un.sanitize(t.entry.content):""});var n=jt(),o=qt(n);{var i=l=>{var d=Wn(),m=E(d),b=E(m);{var v=I=>{var P=Hn();P.__click=function(...re){var tt;(tt=t.onBack)==null||tt.apply(this,re)},N(I,P)};ie(b,I=>{t.onBack&&I(v)})}var k=R(b,2),L=E(k,!0);x(k);var u=R(k,2),_=E(u);{var p=I=>{var P=zn(),re=E(P,!0);x(P),ue(()=>se(re,t.entry.author)),N(I,P)};ie(_,I=>{t.entry.author&&I(p)})}var w=R(_,2),O=E(w,!0);x(w);var C=R(w,2);x(u);var A=R(u,2),D=E(A);D.__click=()=>ve.toggleSaved(t.entry.id,oe.accessToken);var H=E(D,!0);x(D);var K=R(D,2);{var z=I=>{var P=Bn();P.__click=()=>ve.markUnread(t.entry.id,oe.accessToken),N(I,P)},M=Fe(()=>ve.isRead(t.entry.id));ie(K,I=>{c(M)&&I(z)})}x(A),x(m);var Z=R(m,2),T=E(Z);{var U=I=>{var P=jt(),re=qt(P);Qa(re,()=>c(a)),N(I,P)},le=I=>{var P=Gn(),re=E(P,!0);x(P),ue(()=>se(re,t.entry.summary)),N(I,P)};ie(T,I=>{c(a)?I(U):I(le,!1)})}x(Z),x(d),ue((I,P,re)=>{se(L,t.entry.title),se(O,I),Jt(C,"href",t.entry.url),Ee(D,1,`rounded-md px-3 py-1 text-xs ${P??""}`),se(H,re)},[()=>new Date(t.entry.published).toLocaleDateString(),()=>ve.isSaved(t.entry.id)?"bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200":"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400",()=>ve.isSaved(t.entry.id)?"Saved":"Save"]),N(l,d)},f=l=>{var d=jn();N(l,d)};ie(o,l=>{t.entry?l(i):l(f,!1)})}N(e,n),He()}et(["click"]);var Vn=Xr('<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>'),Xn=Xr('<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>'),qn=G('<button class="rounded-md bg-gray-100 px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700">Sign out</button>'),Kn=G('<button class="rounded-md bg-indigo-600 px-3 py-1.5 text-sm text-white hover:bg-indigo-700">Sign in with Google</button>'),Jn=G('<header class="flex items-center justify-between border-b border-gray-200 bg-white px-4 py-3 dark:border-gray-700 dark:bg-gray-900"><div class="flex items-center gap-3"><button class="rounded p-1 text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800 lg:hidden" aria-label="Toggle sidebar"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button> <h1 class="text-xl font-bold text-gray-900 dark:text-white">Readly</h1></div> <div class="flex items-center gap-2"><button class="rounded p-1.5 text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800" aria-label="Toggle dark mode"><!></button> <!></div></header>');function Zn(e,t){Ue(t,!0);let a=V(!1);$r(()=>{y(a,localStorage.getItem("theme")==="dark"||!localStorage.getItem("theme")&&window.matchMedia("(prefers-color-scheme: dark)").matches,!0),n()});function n(){document.documentElement.classList.toggle("dark",c(a))}function o(){y(a,!c(a)),localStorage.setItem("theme",c(a)?"dark":"light"),n()}var i=Jn(),f=E(i),l=E(f);l.__click=function(...p){var w;(w=t.onToggleSidebar)==null||w.apply(this,p)},Xa(2),x(f);var d=R(f,2),m=E(d);m.__click=o;var b=E(m);{var v=p=>{var w=Vn();N(p,w)},k=p=>{var w=Xn();N(p,w)};ie(b,p=>{c(a)?p(v):p(k,!1)})}x(m);var L=R(m,2);{var u=p=>{var w=qn();w.__click=()=>oe.signOut(),N(p,w)},_=p=>{var w=Kn();w.__click=()=>oe.signIn(),N(p,w)};ie(L,p=>{oe.isSignedIn?p(u):p(_,!1)})}x(d),x(i),N(e,i),He()}et(["click"]);var Qn=G('<div class="group flex items-center"><button> <span class="ml-1 text-xs text-gray-400 dark:text-gray-500"> </span></button> <button class="ml-1 hidden rounded p-1 text-gray-400 hover:text-red-500 group-hover:block dark:hover:text-red-400" aria-label="Remove feed"><svg class="h-3.5 w-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div>'),$n=G('<p class="px-3 py-2 text-sm text-gray-400 dark:text-gray-500">No feeds yet. <button class="text-indigo-500 hover:underline">Add one</button></p>'),eo=G('<nav class="flex h-full flex-col overflow-y-auto border-r border-gray-200 bg-gray-50 dark:border-gray-700 dark:bg-gray-900"><div class="p-3"><button>All feeds</button></div> <div class="flex-1 px-3 pb-3"><div class="mb-1 flex items-center justify-between px-3"><h2 class="text-xs font-semibold uppercase tracking-wider text-gray-500 dark:text-gray-400">Subscriptions</h2> <button class="rounded p-0.5 text-gray-400 hover:bg-gray-200 hover:text-gray-600 dark:hover:bg-gray-700 dark:hover:text-gray-300" aria-label="Add feed"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg></button></div> <!> <!></div> <div class="border-t border-gray-200 px-3 py-2 dark:border-gray-700"><div class="flex gap-2"><button class="flex-1 rounded-md px-2 py-1.5 text-xs text-gray-500 hover:bg-gray-200 dark:text-gray-400 dark:hover:bg-gray-800">Import OPML</button> <button class="flex-1 rounded-md px-2 py-1.5 text-xs text-gray-500 hover:bg-gray-200 dark:text-gray-400 dark:hover:bg-gray-800">Export OPML</button></div></div></nav>');function to(e,t){Ue(t,!0);var a=eo(),n=E(a),o=E(n);o.__click=function(..._){var p;(p=t.onSelectAll)==null||p.apply(this,_)},x(n);var i=R(n,2),f=E(i),l=R(E(f),2);l.__click=function(..._){var p;(p=t.onAddFeed)==null||p.apply(this,_)},x(f);var d=R(f,2);ea(d,17,()=>t.feeds,_=>_.url,(_,p)=>{var w=Qn(),O=E(w);O.__click=()=>t.onSelectFeed(c(p).url);var C=E(O),A=R(C),D=E(A,!0);x(A),x(O);var H=R(O,2);H.__click=()=>t.onRemoveFeed(c(p).url),x(w),ue(()=>{Ee(O,1,`flex-1 truncate rounded-md px-3 py-1.5 text-left text-sm ${t.selectedFeedUrl===c(p).url?"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200":"text-gray-600 hover:bg-gray-200 dark:text-gray-400 dark:hover:bg-gray-800"}`),se(C,`${c(p).title??""} `),se(D,c(p).entries.length)}),N(_,w)});var m=R(d,2);{var b=_=>{var p=$n(),w=R(E(p));w.__click=function(...O){var C;(C=t.onAddFeed)==null||C.apply(this,O)},x(p),N(_,p)};ie(m,_=>{t.feeds.length===0&&_(b)})}x(i);var v=R(i,2),k=E(v),L=E(k);L.__click=function(..._){var p;(p=t.onImportOpml)==null||p.apply(this,_)};var u=R(L,2);u.__click=function(..._){var p;(p=t.onExportOpml)==null||p.apply(this,_)},x(k),x(v),x(a),ue(()=>Ee(o,1,`w-full rounded-md px-3 py-2 text-left text-sm font-medium ${t.selectedFeedUrl===null?"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200":"text-gray-700 hover:bg-gray-200 dark:text-gray-300 dark:hover:bg-gray-800"}`)),N(e,a),He()}et(["click"]);function ro(e){const n=new DOMParser().parseFromString(e,"text/xml").querySelectorAll("outline[xmlUrl]"),o=[];return n.forEach(i=>{var m;const f=i.getAttribute("xmlUrl");if(!f)return;const l=i.getAttribute("title")||i.getAttribute("text")||f,d=((m=i.parentElement)==null?void 0:m.getAttribute("text"))??"";o.push({url:f,title:l,folder:d,added:new Date().toISOString()})}),o}function ao(e){const t=new Map;for(const n of e){const o=n.folder||"";t.has(o)||t.set(o,[]),t.get(o).push(n)}let a="";for(const[n,o]of t){const i=o.map(f=>`      <outline type="rss" text="${mt(f.title)}" title="${mt(f.title)}" xmlUrl="${mt(f.url)}" />`).join(`
`);n?a+=`    <outline text="${mt(n)}">
${i}
    </outline>
`:a+=i+`
`}return`<?xml version="1.0" encoding="UTF-8"?>
<opml version="2.0">
  <head>
    <title>Readly Subscriptions</title>
    <dateCreated>${new Date().toUTCString()}</dateCreated>
  </head>
  <body>
${a}  </body>
</opml>`}function mt(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}var no=G('<div class="fixed bottom-4 right-4 rounded-md bg-indigo-600 px-3 py-1.5 text-sm text-white shadow-lg">Loading feeds...</div>'),oo=G('<div class="fixed bottom-4 right-4 rounded-md bg-red-600 px-3 py-1.5 text-sm text-white shadow-lg"> </div>'),io=G('<div class="flex h-screen flex-col bg-white dark:bg-gray-950"><!> <div class="flex flex-1 overflow-hidden"><div><!></div> <div><!></div> <div><!></div></div> <!> <!> <!></div>');function uo(e,t){Ue(t,!0);let a=V(!1),n=V(null),o=V(null),i=V(!1),f=V("list"),l=Fe(()=>{var T,U;return c(n)?((U=(T=we.bundle)==null?void 0:T.feeds[c(n)])==null?void 0:U.entries)??[]:we.allEntries});$r(()=>{oe.handleRedirect(),we.loadBundle(),oe.isSignedIn&&oe.accessToken&&(ve.loadFromDrive(oe.accessToken),Qe.loadFromDrive(oe.accessToken))});function d(T){y(o,T,!0),y(f,"entry"),ve.markRead(T.id,oe.accessToken)}function m(){y(o,null),y(f,"list")}async function b(T){await Qe.removeFeed(T,oe.accessToken),c(n)===T&&(y(n,null),y(o,null))}function v(){const T=document.createElement("input");T.type="file",T.accept=".opml,.xml",T.onchange=async()=>{var P;const U=(P=T.files)==null?void 0:P[0];if(!U)return;const le=await U.text(),I=ro(le);for(const re of I)await Qe.addFeed(re.url,re.title,oe.accessToken)},T.click()}function k(){const T=ao(Qe.feeds),U=new Blob([T],{type:"text/xml"}),le=URL.createObjectURL(U),I=document.createElement("a");I.href=le,I.download="readly-subscriptions.opml",I.click(),URL.revokeObjectURL(le)}var L=io(),u=E(L);Zn(u,{onToggleSidebar:()=>y(a,!c(a))});var _=R(u,2),p=E(_),w=E(p);to(w,{get feeds(){return we.feeds},get selectedFeedUrl(){return c(n)},onSelectFeed:T=>{y(n,T,!0),y(o,null),y(f,"list"),y(a,!1)},onSelectAll:()=>{y(n,null),y(o,null),y(f,"list"),y(a,!1)},onAddFeed:()=>y(i,!0),onRemoveFeed:b,onImportOpml:v,onExportOpml:k}),x(p);var O=R(p,2),C=E(O);{let T=Fe(()=>{var U;return((U=c(o))==null?void 0:U.id)??null});vn(C,{get entries(){return c(l)},get selectedEntryId(){return c(T)},onSelectEntry:d})}x(O);var A=R(O,2),D=E(A);Yn(D,{get entry(){return c(o)},onBack:m}),x(A),x(_);var H=R(_,2);{var K=T=>{var U=no();N(T,U)};ie(H,T=>{we.loadingState==="loading"&&T(K)})}var z=R(H,2);{var M=T=>{var U=oo(),le=E(U,!0);x(U),ue(()=>se(le,we.error)),N(T,U)};ie(z,T=>{we.loadingState==="error"&&T(M)})}var Z=R(z,2);fn(Z,{get open(){return c(i)},onClose:()=>y(i,!1)}),x(L),ue(()=>{Ee(p,1,`w-64 shrink-0 ${c(a)?"block":"hidden"} lg:block`),Ee(O,1,`w-full shrink-0 lg:w-80 ${c(f)==="entry"?"hidden lg:block":"block"}`),Ee(A,1,`flex-1 ${c(f)==="list"?"hidden lg:block":"block"}`)}),N(e,L),He()}export{uo as component};
