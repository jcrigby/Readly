import{b as kr,d as va,c as Vt,a as N,f as U,e as qr}from"../chunks/DhaZ0PH4.js";import{b as ha,h as le,a as Xt,K as c,r as _a,c as ya,s as Rr,d as qt,e as Lt,l as Ne,Z as Kr,aq as ba,a9 as Or,f as Me,j as Dr,aN as be,k as Kt,aO as Ta,n as Ea,aF as xa,aP as Aa,ao as rr,aQ as wa,aR as Sa,aJ as ka,W as Ir,aS as Ra,g as Jr,p as Zr,aT as Ct,aU as Oa,an as Da,i as Ia,ak as Qr,O as ce,w as La,aV as Ca,ar as Ma,al as Na,x as dt,Y as Fa,aW as Pa,aX as Ua,aY as Ha,aZ as za,a_ as Ba,a$ as Ga,b0 as Wa,aK as ja,G as Ya,V as Va,b1 as Xa,aM as Pe,aL as Y,ay as y,ax as $r,o as He,t as Jt,u as ze,P as E,S as R,Q as x,q as ea,aa as qa}from"../chunks/B56_dkfp.js";import{d as rt,s as se,e as Ka}from"../chunks/LqdzY0r8.js";import{i as re}from"../chunks/iND0BaTL.js";function Ja(e,t,a){for(var n=[],o=t.length,i,f=t.length,l=0;l<o;l++){let v=t[l];Zr(v,()=>{if(i){if(i.pending.delete(v),i.done.add(v),i.pending.size===0){var O=e.outrogroups;Zt(rr(i.done)),O.delete(i),O.size===0&&(e.outrogroups=null)}}else f-=1},!1)}if(f===0){var d=n.length===0&&a!==null;if(d){var m=a,b=m.parentNode;Da(b),b.append(m),e.items.clear()}Zt(t,!d)}else i={pending:new Set(t),done:new Set},(e.outrogroups??(e.outrogroups=new Set)).add(i)}function Zt(e,t=!0){for(var a=0;a<e.length;a++)Ia(e[a],t)}var Lr;function ta(e,t,a,n,o,i=null){var f=e,l=new Map;le&&Xt();var d=null,m=xa(()=>{var _=a();return Aa(_)?_:_==null?[]:rr(_)}),b,v=!0;function O(){u.fallback=d,Za(u,b,f,t,n),d!==null&&(b.length===0?(d.f&be)===0?Jr(d):(d.f^=be,$e(d,null,f)):Zr(d,()=>{d=null}))}var C=ha(()=>{b=c(m);var _=b.length;let p=!1;if(le){var w=_a(f)===ya;w!==(_===0)&&(f=Rr(),qt(f),Lt(!1),p=!0)}for(var D=new Set,M=Me,A=Ea(),I=0;I<_;I+=1){le&&Ne.nodeType===Kr&&Ne.data===ba&&(f=Ne,p=!0,Lt(!1));var H=b[I],J=n(H,I),z=v?null:l.get(J);z?(z.v&&Or(z.v,H),z.i&&Or(z.i,I),A&&M.unskip_effect(z.e)):(z=Qa(l,v?f:Lr??(Lr=Dr()),H,J,I,o,t,a),v||(z.e.f|=be),l.set(J,z)),D.add(J)}if(_===0&&i&&!d&&(v?d=Kt(()=>i(f)):(d=Kt(()=>i(Lr??(Lr=Dr()))),d.f|=be)),_>D.size&&Ta(),le&&_>0&&qt(Rr()),!v)if(A){for(const[F,Z]of l)D.has(F)||M.skip_effect(Z.e);M.oncommit(O),M.ondiscard(()=>{})}else O();p&&Lt(!0),c(m)}),u={effect:C,items:l,outrogroups:null,fallback:d};v=!1,le&&(f=Ne)}function Ye(e){for(;e!==null&&(e.f&Oa)===0;)e=e.next;return e}function Za(e,t,a,n,o){var z;var i=t.length,f=e.items,l=Ye(e.effect.first),d,m=null,b=[],v=[],O,C,u,_;for(_=0;_<i;_+=1){if(O=t[_],C=o(O,_),u=f.get(C).e,e.outrogroups!==null)for(const F of e.outrogroups)F.pending.delete(u),F.done.delete(u);if((u.f&be)!==0)if(u.f^=be,u===l)$e(u,null,a);else{var p=m?m.next:l;u===e.effect.last&&(e.effect.last=u.prev),u.prev&&(u.prev.next=u.next),u.next&&(u.next.prev=u.prev),ye(e,m,u),ye(e,u,p),$e(u,p,a),m=u,b=[],v=[],l=Ye(m.next);continue}if((u.f&Ct)!==0&&Jr(u),u!==l){if(d!==void 0&&d.has(u)){if(b.length<v.length){var w=v[0],D;m=w.prev;var M=b[0],A=b[b.length-1];for(D=0;D<b.length;D+=1)$e(b[D],w,a);for(D=0;D<v.length;D+=1)d.delete(v[D]);ye(e,M.prev,A.next),ye(e,m,M),ye(e,A,w),l=w,m=A,_-=1,b=[],v=[]}else d.delete(u),$e(u,l,a),ye(e,u.prev,u.next),ye(e,u,m===null?e.effect.first:m.next),ye(e,m,u),m=u;continue}for(b=[],v=[];l!==null&&l!==u;)(d??(d=new Set)).add(l),v.push(l),l=Ye(l.next);if(l===null)continue}(u.f&be)===0&&b.push(u),m=u,l=Ye(u.next)}if(e.outrogroups!==null){for(const F of e.outrogroups)F.pending.size===0&&(Zt(rr(F.done)),(z=e.outrogroups)==null||z.delete(F));e.outrogroups.size===0&&(e.outrogroups=null)}if(l!==null||d!==void 0){var I=[];if(d!==void 0)for(u of d)(u.f&Ct)===0&&I.push(u);for(;l!==null;)(l.f&Ct)===0&&l!==e.fallback&&I.push(l),l=Ye(l.next);var H=I.length;if(H>0){var J=null;Ja(e,I,J)}}}function Qa(e,t,a,n,o,i,f,l){var d=(f&wa)!==0?(f&Sa)===0?ka(a,!1,!1):Ir(a):null,m=(f&Ra)!==0?Ir(o):null;return{v:d,i:m,e:Kt(()=>(i(t,d??a,m??o,l),()=>{e.delete(n)}))}}function $e(e,t,a){if(e.nodes)for(var n=e.nodes.start,o=e.nodes.end,i=t&&(t.f&be)===0?t.nodes.start:a;n!==null;){var f=Qr(n);if(i.before(n),n===o)return;n=f}}function ye(e,t,a){t===null?e.effect.first=a:t.next=a,a===null?e.effect.last=t:a.prev=t}function $a(e,t,a=!1,n=!1,o=!1){var i=e,f="";ce(()=>{var l=La;if(f===(f=t()??"")){le&&Xt();return}if(l.nodes!==null&&(Ca(l.nodes.start,l.nodes.end),l.nodes=null),f!==""){if(le){Ne.data;for(var d=Xt(),m=d;d!==null&&(d.nodeType!==Kr||d.data!=="");)m=d,d=Qr(d);if(d===null)throw Ma(),Na;kr(Ne,m),i=qt(d);return}var b=f+"";a?b=`<svg>${b}</svg>`:n&&(b=`<math>${b}</math>`);var v=va(b);if((a||n)&&(v=dt(v)),kr(dt(v),v.lastChild),a||n)for(;dt(v);)i.before(dt(v));else i.before(v)}})}function en(e,t,a){var n=e==null?"":""+e;return n===""?null:n}function Te(e,t,a,n,o,i){var f=e.__className;if(le||f!==a||f===void 0){var l=en(a);(!le||l!==e.getAttribute("class"))&&(l==null?e.removeAttribute("class"):e.className=l),e.__className=a}return i}const tn=Symbol("is custom element"),rn=Symbol("is html"),an=za?"link":"LINK";function Cr(e){if(le){var t=!1,a=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var n=e.value;Qt(e,"value",null),e.value=n}if(e.hasAttribute("checked")){var o=e.checked;Qt(e,"checked",null),e.checked=o}}};e.__on_r=a,Fa(a),Pa()}}function Qt(e,t,a,n){var o=nn(e);le&&(o[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName===an)||o[t]!==(o[t]=a)&&(t==="loading"&&(e[Ua]=a),a==null?e.removeAttribute(t):typeof a!="string"&&on(e).includes(t)?e[t]=a:e.setAttribute(t,a))}function nn(e){return e.__attributes??(e.__attributes={[tn]:e.nodeName.includes("-"),[rn]:e.namespaceURI===Ha})}var Mr=new Map;function on(e){var t=e.getAttribute("is")||e.nodeName,a=Mr.get(t);if(a)return a;Mr.set(t,a=[]);for(var n,o=e,i=Element.prototype;i!==o;){n=Ga(o);for(var f in n)n[f].set&&a.push(f);o=Ba(o)}return a}function Nr(e,t,a=t){var n=new WeakSet;Wa(e,"input",async o=>{var i=o?e.defaultValue:e.value;if(i=Mt(e)?Nt(i):i,a(i),Me!==null&&n.add(Me),await ja(),i!==(i=t())){var f=e.selectionStart,l=e.selectionEnd,d=e.value.length;if(e.value=i??"",l!==null){var m=e.value.length;f===l&&l===d&&m>d?(e.selectionStart=m,e.selectionEnd=m):(e.selectionStart=f,e.selectionEnd=Math.min(l,m))}}}),(le&&e.defaultValue!==e.value||Ya(t)==null&&e.value)&&(a(Mt(e)?Nt(e.value):e.value),Me!==null&&n.add(Me)),Va(()=>{var o=t();if(e===document.activeElement){var i=Xa??Me;if(n.has(i))return}Mt(e)&&o===Nt(e.value)||e.type==="date"&&!o&&!e.value||o!==e.value&&(e.value=o??"")})}function Mt(e){var t=e.type;return t==="number"||t==="range"}function Nt(e){return e===""?null:+e}let Fe=Y(null),Ft=Y(null);const Fr=Pe(()=>{var e;return c(Fe)!==null&&Date.now()<(((e=c(Fe))==null?void 0:e.expiresAt)??0)}),$={get tokens(){return c(Fe)},get isSignedIn(){return c(Fr)},get accessToken(){return c(Fr)?c(Fe).accessToken:null},get authError(){return c(Ft)},signIn(){y(Ft,null);{y(Ft,"Google OAuth not configured. Set VITE_GOOGLE_CLIENT_ID in .env to enable sign in.");return}},signOut(){y(Fe,null)},handleRedirect(){const e=window.location.hash;if(!e.includes("access_token"))return!1;const t=new URLSearchParams(e.slice(1)),a=t.get("access_token"),n=t.get("expires_in");return a&&n?(y(Fe,{accessToken:a,expiresAt:Date.now()+parseInt(n)*1e3},!0),window.history.replaceState(null,"",window.location.pathname),!0):!1}},ht="https://www.googleapis.com/drive/v3",Pr="https://www.googleapis.com/upload/drive/v3",Ur="readly",pt="application/json";function Ue(e){return{Authorization:`Bearer ${e}`}}async function _t(e){const t=`name='${Ur}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,a=`${ht}/files?q=${encodeURIComponent(t)}&fields=files(id,name)`,n=await fetch(a,{headers:Ue(e)});if(!n.ok)throw new Error(`Drive search failed: ${n.status}`);const o=await n.json();if(o.files.length>0)return o.files[0].id;const i=await fetch(`${ht}/files`,{method:"POST",headers:{...Ue(e),"Content-Type":pt},body:JSON.stringify({name:Ur,mimeType:"application/vnd.google-apps.folder"})});if(!i.ok)throw new Error(`Drive folder creation failed: ${i.status}`);return(await i.json()).id}async function ar(e,t,a){const n=`name='${a}' and '${t}' in parents and trashed=false`,o=`${ht}/files?q=${encodeURIComponent(n)}&fields=files(id)`,i=await fetch(o,{headers:Ue(e)});if(!i.ok)throw new Error(`Drive file search failed: ${i.status}`);const f=await i.json();return f.files.length>0?f.files[0].id:null}async function ra(e,t){const a=`${ht}/files/${t}?alt=media`,n=await fetch(a,{headers:Ue(e)});if(!n.ok)throw new Error(`Drive read failed: ${n.status}`);return await n.json()}async function yt(e,t,a,n){const o=await ar(e,t,a),i=JSON.stringify(n);if(o){const O=`${Pr}/files/${o}?uploadType=media`,C=await fetch(O,{method:"PATCH",headers:{...Ue(e),"Content-Type":pt},body:i});if(!C.ok)throw new Error(`Drive update failed: ${C.status}`);return o}const f=JSON.stringify({name:a,parents:[t]}),l="feedle_boundary",d=`--${l}\r
Content-Type: ${pt}\r
\r
${f}\r
--${l}\r
Content-Type: ${pt}\r
\r
${i}\r
--${l}--`,m=`${Pr}/files?uploadType=multipart`,b=await fetch(m,{method:"POST",headers:{...Ue(e),"Content-Type":`multipart/related; boundary=${l}`},body:d});if(!b.ok)throw new Error(`Drive create failed: ${b.status}`);return(await b.json()).id}async function sn(e){const t=await _t(e),a=await ar(e,t,"config.json");if(!a){const n={feeds:[],folders:[],preferences:{refreshInterval:30,theme:"system",defaultView:"unread"}};return await yt(e,t,"config.json",n),n}return ra(e,a)}async function Hr(e,t){const a=await _t(e);await yt(e,a,"config.json",t)}async function ln(e){const t=await _t(e),a=await ar(e,t,"state.json");if(!a){const n={read:[],saved:[],lastSync:new Date().toISOString()};return await yt(e,t,"state.json",n),n}return ra(e,a)}async function cn(e,t){const a=await _t(e);await yt(e,a,"state.json",t)}let ie=Y($r({feeds:[],folders:[],preferences:{refreshInterval:30,theme:"system",defaultView:"unread"}})),Pt=Y(!1);const et={get config(){return c(ie)},get feeds(){return c(ie).feeds},get syncing(){return c(Pt)},async loadFromDrive(e){y(Pt,!0);try{y(ie,await sn(e),!0)}catch(t){console.error("Failed to load config from Drive:",t)}finally{y(Pt,!1)}},async addFeed(e,t,a){if(c(ie).feeds.some(o=>o.url===e))return;const n={url:e,title:t,folder:"",added:new Date().toISOString()};if(y(ie,{...c(ie),feeds:[...c(ie).feeds,n]},!0),a)try{await Hr(a,c(ie))}catch(o){console.error("Failed to save config to Drive:",o)}},async removeFeed(e,t){if(y(ie,{...c(ie),feeds:c(ie).feeds.filter(a=>a.url!==e)},!0),t)try{await Hr(t,c(ie))}catch(a){console.error("Failed to save config to Drive:",a)}},setFeeds(e){y(ie,{...c(ie),feeds:e},!0)}};let Ve=Y(null),Xe=Y("idle"),ft=Y(null);const Se={get bundle(){return c(Ve)},get loadingState(){return c(Xe)},get error(){return c(ft)},get feeds(){return c(Ve)?Object.values(c(Ve).feeds):[]},get allEntries(){return this.feeds.flatMap(e=>e.entries).sort((e,t)=>new Date(t.published).getTime()-new Date(e.published).getTime())},async loadBundle(e="/feed-bundle.json"){y(Xe,"loading"),y(ft,null);try{let t=await fetch(e);if(t.ok,!t.ok)throw new Error(`Failed to fetch bundle: ${t.status}`);y(Ve,await t.json(),!0),y(Xe,"success")}catch(t){y(ft,t instanceof Error?t.message:"Unknown error",!0),y(Xe,"error")}},setBundle(e){y(Ve,e,!0),y(Xe,"success"),y(ft,null)}};let te=Y($r({read:[],saved:[],lastSync:new Date().toISOString()})),tt=Y(!1),Ut=null;function Ht(e){Ut&&clearTimeout(Ut),Ut=setTimeout(async()=>{y(tt,!0);try{await cn(e,c(te))}catch(t){console.error("Failed to sync state to Drive:",t)}finally{y(tt,!1)}},1e3)}const pe={get state(){return c(te)},get syncing(){return c(tt)},isRead(e){return c(te).read.includes(e)},isSaved(e){return c(te).saved.includes(e)},markRead(e,t){c(te).read.includes(e)||(c(te).read=[...c(te).read,e],t&&Ht(t))},markUnread(e,t){c(te).read=c(te).read.filter(a=>a!==e),t&&Ht(t)},toggleSaved(e,t){c(te).saved.includes(e)?c(te).saved=c(te).saved.filter(a=>a!==e):c(te).saved=[...c(te).saved,e],t&&Ht(t)},async loadFromDrive(e){y(tt,!0);try{y(te,await ln(e),!0)}catch(t){console.error("Failed to load state from Drive:",t)}finally{y(tt,!1)}}};var dn=U('<p class="mb-3 text-sm text-red-600 dark:text-red-400"> </p>'),fn=U('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50" role="dialog" aria-modal="true" tabindex="-1"><div class="mx-4 w-full max-w-md rounded-lg bg-white p-6 shadow-xl dark:bg-gray-800"><h2 class="mb-4 text-lg font-semibold text-gray-900 dark:text-white">Add Feed</h2> <form><div class="mb-3"><label for="feed-url" class="mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300">Feed URL</label> <input id="feed-url" type="url" placeholder="https://example.com/feed.xml" class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white" required=""/></div> <div class="mb-4"><label for="feed-title" class="mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300">Title (optional)</label> <input id="feed-title" type="text" placeholder="My Favorite Blog" class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"/></div> <!> <div class="flex justify-end gap-2"><button type="button" class="rounded-md px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700">Cancel</button> <button type="submit" class="rounded-md bg-indigo-600 px-4 py-2 text-sm text-white hover:bg-indigo-700 disabled:opacity-50"> </button></div></form></div></div>');function un(e,t){He(t,!0);let a=Y(""),n=Y(""),o=Y(!1),i=Y("");async function f(){if(!c(a).trim()){y(i,"Please enter a feed URL");return}y(o,!0),y(i,"");try{const v=c(n).trim()||new URL(c(a)).hostname;await et.addFeed(c(a).trim(),v,$.accessToken),y(a,""),y(n,""),t.onClose()}catch(v){y(i,v instanceof Error?v.message:"Failed to add feed",!0)}finally{y(o,!1)}}function l(v){v.key==="Escape"&&t.onClose()}var d=Vt(),m=Jt(d);{var b=v=>{var O=fn();O.__keydown=l;var C=E(O),u=R(E(C),2),_=E(u),p=R(E(_),2);Cr(p),x(_);var w=R(_,2),D=R(E(w),2);Cr(D),x(w);var M=R(w,2);{var A=F=>{var Z=dn(),B=E(Z,!0);x(Z),ce(()=>se(B,c(i))),N(F,Z)};re(M,F=>{c(i)&&F(A)})}var I=R(M,2),H=E(I);H.__click=function(...F){var Z;(Z=t.onClose)==null||Z.apply(this,F)};var J=R(H,2),z=E(J,!0);x(J),x(I),x(u),x(C),x(O),ce(()=>{J.disabled=c(o),se(z,c(o)?"Adding...":"Add Feed")}),Ka("submit",u,F=>{F.preventDefault(),f()}),Nr(p,()=>c(a),F=>y(a,F)),Nr(D,()=>c(n),F=>y(n,F)),N(v,O)};re(m,v=>{t.open&&v(b)})}N(e,d),ze()}rt(["keydown","click"]);var mn=U('<span class="text-amber-500">Saved</span>'),gn=U('<button><h3> </h3> <p class="mt-0.5 line-clamp-2 text-xs text-gray-500 dark:text-gray-400"> </p> <div class="mt-1 flex items-center gap-2 text-xs text-gray-400 dark:text-gray-500"><span> </span> <!></div></button>'),pn=U('<div class="flex flex-1 items-center justify-center p-8"><p class="text-sm text-gray-400 dark:text-gray-500">No entries to show.</p></div>'),vn=U('<div class="flex h-full flex-col overflow-y-auto border-r border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-950"><!> <!></div>');function hn(e,t){He(t,!0);function a(l){const d=new Date(l),b=new Date().getTime()-d.getTime(),v=Math.floor(b/36e5);if(v<1)return"Just now";if(v<24)return`${v}h ago`;const O=Math.floor(v/24);return O<7?`${O}d ago`:d.toLocaleDateString()}var n=vn(),o=E(n);ta(o,17,()=>t.entries,l=>l.id,(l,d)=>{var m=gn();m.__click=()=>t.onSelectEntry(c(d));var b=E(m),v=E(b,!0);x(b);var O=R(b,2),C=E(O,!0);x(O);var u=R(O,2),_=E(u),p=E(_,!0);x(_);var w=R(_,2);{var D=A=>{var I=mn();N(A,I)},M=Pe(()=>pe.isSaved(c(d).id));re(w,A=>{c(M)&&A(D)})}x(u),x(m),ce((A,I,H)=>{Te(m,1,`border-b border-gray-100 px-4 py-3 text-left transition-colors dark:border-gray-800
				${t.selectedEntryId===c(d).id?"bg-indigo-50 dark:bg-indigo-950":"hover:bg-gray-50 dark:hover:bg-gray-900"}
				${A??""}`),Te(b,1,`text-sm font-medium text-gray-900 dark:text-gray-100 ${I??""}`),se(v,c(d).title),se(C,c(d).summary),se(p,H)},[()=>pe.isRead(c(d).id)?"opacity-60":"",()=>pe.isRead(c(d).id)?"font-normal":"",()=>a(c(d).published)]),N(l,m)});var i=R(o,2);{var f=l=>{var d=pn();N(l,d)};re(i,l=>{t.entries.length===0&&l(f)})}x(n),N(e,n),ze()}rt(["click"]);/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:aa,setPrototypeOf:zr,isFrozen:_n,getPrototypeOf:yn,getOwnPropertyDescriptor:bn}=Object;let{freeze:ae,seal:de,create:$t}=Object,{apply:er,construct:tr}=typeof Reflect<"u"&&Reflect;ae||(ae=function(t){return t});de||(de=function(t){return t});er||(er=function(t,a){for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];return t.apply(a,o)});tr||(tr=function(t){for(var a=arguments.length,n=new Array(a>1?a-1:0),o=1;o<a;o++)n[o-1]=arguments[o];return new t(...n)});const ut=ne(Array.prototype.forEach),Tn=ne(Array.prototype.lastIndexOf),Br=ne(Array.prototype.pop),qe=ne(Array.prototype.push),En=ne(Array.prototype.splice),vt=ne(String.prototype.toLowerCase),zt=ne(String.prototype.toString),Bt=ne(String.prototype.match),Ke=ne(String.prototype.replace),xn=ne(String.prototype.indexOf),An=ne(String.prototype.trim),fe=ne(Object.prototype.hasOwnProperty),ee=ne(RegExp.prototype.test),Je=wn(TypeError);function ne(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var a=arguments.length,n=new Array(a>1?a-1:0),o=1;o<a;o++)n[o-1]=arguments[o];return er(e,t,n)}}function wn(e){return function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return tr(e,a)}}function k(e,t){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:vt;zr&&zr(e,null);let n=t.length;for(;n--;){let o=t[n];if(typeof o=="string"){const i=a(o);i!==o&&(_n(t)||(t[n]=i),o=i)}e[o]=!0}return e}function Sn(e){for(let t=0;t<e.length;t++)fe(e,t)||(e[t]=null);return e}function ge(e){const t=$t(null);for(const[a,n]of aa(e))fe(e,a)&&(Array.isArray(n)?t[a]=Sn(n):n&&typeof n=="object"&&n.constructor===Object?t[a]=ge(n):t[a]=n);return t}function Ze(e,t){for(;e!==null;){const n=bn(e,t);if(n){if(n.get)return ne(n.get);if(typeof n.value=="function")return ne(n.value)}e=yn(e)}function a(){return null}return a}const Gr=ae(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Gt=ae(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Wt=ae(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),kn=ae(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),jt=ae(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Rn=ae(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Wr=ae(["#text"]),jr=ae(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Yt=ae(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Yr=ae(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),mt=ae(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),On=de(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Dn=de(/<%[\w\W]*|[\w\W]*%>/gm),In=de(/\$\{[\w\W]*/gm),Ln=de(/^data-[\-\w.\u00B7-\uFFFF]+$/),Cn=de(/^aria-[\-\w]+$/),na=de(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Mn=de(/^(?:\w+script|data):/i),Nn=de(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),oa=de(/^html$/i),Fn=de(/^[a-z][.\w]*(-[.\w]+)+$/i);var Vr=Object.freeze({__proto__:null,ARIA_ATTR:Cn,ATTR_WHITESPACE:Nn,CUSTOM_ELEMENT:Fn,DATA_ATTR:Ln,DOCTYPE_NAME:oa,ERB_EXPR:Dn,IS_ALLOWED_URI:na,IS_SCRIPT_OR_DATA:Mn,MUSTACHE_EXPR:On,TMPLIT_EXPR:In});const Qe={element:1,text:3,progressingInstruction:7,comment:8,document:9},Pn=function(){return typeof window>"u"?null:window},Un=function(t,a){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let n=null;const o="data-tt-policy-suffix";a&&a.hasAttribute(o)&&(n=a.getAttribute(o));const i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML(f){return f},createScriptURL(f){return f}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},Xr=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function ia(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pn();const t=h=>ia(h);if(t.version="3.3.1",t.removed=[],!e||!e.document||e.document.nodeType!==Qe.document||!e.Element)return t.isSupported=!1,t;let{document:a}=e;const n=a,o=n.currentScript,{DocumentFragment:i,HTMLTemplateElement:f,Node:l,Element:d,NodeFilter:m,NamedNodeMap:b=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:v,DOMParser:O,trustedTypes:C}=e,u=d.prototype,_=Ze(u,"cloneNode"),p=Ze(u,"remove"),w=Ze(u,"nextSibling"),D=Ze(u,"childNodes"),M=Ze(u,"parentNode");if(typeof f=="function"){const h=a.createElement("template");h.content&&h.content.ownerDocument&&(a=h.content.ownerDocument)}let A,I="";const{implementation:H,createNodeIterator:J,createDocumentFragment:z,getElementsByTagName:F}=a,{importNode:Z}=n;let B=Xr();t.isSupported=typeof aa=="function"&&typeof M=="function"&&H&&H.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Ee,ERB_EXPR:S,TMPLIT_EXPR:T,DATA_ATTR:L,ARIA_ATTR:X,IS_SCRIPT_OR_DATA:xe,ATTR_WHITESPACE:Be,CUSTOM_ELEMENT:sa}=Vr;let{IS_ALLOWED_URI:nr}=Vr,V=null;const or=k({},[...Gr,...Gt,...Wt,...jt,...Wr]);let q=null;const ir=k({},[...jr,...Yt,...Yr,...mt]);let G=Object.seal($t(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ge=null,bt=null;const ke=Object.seal($t(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let sr=!0,Tt=!0,lr=!1,cr=!0,Re=!1,at=!0,Ae=!1,Et=!1,xt=!1,Oe=!1,nt=!1,ot=!1,dr=!0,fr=!1;const la="user-content-";let At=!0,We=!1,De={},ue=null;const wt=k({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ur=null;const mr=k({},["audio","video","img","source","image","track"]);let St=null;const gr=k({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),it="http://www.w3.org/1998/Math/MathML",st="http://www.w3.org/2000/svg",ve="http://www.w3.org/1999/xhtml";let Ie=ve,kt=!1,Rt=null;const ca=k({},[it,st,ve],zt);let lt=k({},["mi","mo","mn","ms","mtext"]),ct=k({},["annotation-xml"]);const da=k({},["title","style","font","a","script"]);let je=null;const fa=["application/xhtml+xml","text/html"],ua="text/html";let j=null,Le=null;const ma=a.createElement("form"),pr=function(r){return r instanceof RegExp||r instanceof Function},Ot=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Le&&Le===r)){if((!r||typeof r!="object")&&(r={}),r=ge(r),je=fa.indexOf(r.PARSER_MEDIA_TYPE)===-1?ua:r.PARSER_MEDIA_TYPE,j=je==="application/xhtml+xml"?zt:vt,V=fe(r,"ALLOWED_TAGS")?k({},r.ALLOWED_TAGS,j):or,q=fe(r,"ALLOWED_ATTR")?k({},r.ALLOWED_ATTR,j):ir,Rt=fe(r,"ALLOWED_NAMESPACES")?k({},r.ALLOWED_NAMESPACES,zt):ca,St=fe(r,"ADD_URI_SAFE_ATTR")?k(ge(gr),r.ADD_URI_SAFE_ATTR,j):gr,ur=fe(r,"ADD_DATA_URI_TAGS")?k(ge(mr),r.ADD_DATA_URI_TAGS,j):mr,ue=fe(r,"FORBID_CONTENTS")?k({},r.FORBID_CONTENTS,j):wt,Ge=fe(r,"FORBID_TAGS")?k({},r.FORBID_TAGS,j):ge({}),bt=fe(r,"FORBID_ATTR")?k({},r.FORBID_ATTR,j):ge({}),De=fe(r,"USE_PROFILES")?r.USE_PROFILES:!1,sr=r.ALLOW_ARIA_ATTR!==!1,Tt=r.ALLOW_DATA_ATTR!==!1,lr=r.ALLOW_UNKNOWN_PROTOCOLS||!1,cr=r.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Re=r.SAFE_FOR_TEMPLATES||!1,at=r.SAFE_FOR_XML!==!1,Ae=r.WHOLE_DOCUMENT||!1,Oe=r.RETURN_DOM||!1,nt=r.RETURN_DOM_FRAGMENT||!1,ot=r.RETURN_TRUSTED_TYPE||!1,xt=r.FORCE_BODY||!1,dr=r.SANITIZE_DOM!==!1,fr=r.SANITIZE_NAMED_PROPS||!1,At=r.KEEP_CONTENT!==!1,We=r.IN_PLACE||!1,nr=r.ALLOWED_URI_REGEXP||na,Ie=r.NAMESPACE||ve,lt=r.MATHML_TEXT_INTEGRATION_POINTS||lt,ct=r.HTML_INTEGRATION_POINTS||ct,G=r.CUSTOM_ELEMENT_HANDLING||{},r.CUSTOM_ELEMENT_HANDLING&&pr(r.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(G.tagNameCheck=r.CUSTOM_ELEMENT_HANDLING.tagNameCheck),r.CUSTOM_ELEMENT_HANDLING&&pr(r.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(G.attributeNameCheck=r.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),r.CUSTOM_ELEMENT_HANDLING&&typeof r.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(G.allowCustomizedBuiltInElements=r.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Re&&(Tt=!1),nt&&(Oe=!0),De&&(V=k({},Wr),q=[],De.html===!0&&(k(V,Gr),k(q,jr)),De.svg===!0&&(k(V,Gt),k(q,Yt),k(q,mt)),De.svgFilters===!0&&(k(V,Wt),k(q,Yt),k(q,mt)),De.mathMl===!0&&(k(V,jt),k(q,Yr),k(q,mt))),r.ADD_TAGS&&(typeof r.ADD_TAGS=="function"?ke.tagCheck=r.ADD_TAGS:(V===or&&(V=ge(V)),k(V,r.ADD_TAGS,j))),r.ADD_ATTR&&(typeof r.ADD_ATTR=="function"?ke.attributeCheck=r.ADD_ATTR:(q===ir&&(q=ge(q)),k(q,r.ADD_ATTR,j))),r.ADD_URI_SAFE_ATTR&&k(St,r.ADD_URI_SAFE_ATTR,j),r.FORBID_CONTENTS&&(ue===wt&&(ue=ge(ue)),k(ue,r.FORBID_CONTENTS,j)),r.ADD_FORBID_CONTENTS&&(ue===wt&&(ue=ge(ue)),k(ue,r.ADD_FORBID_CONTENTS,j)),At&&(V["#text"]=!0),Ae&&k(V,["html","head","body"]),V.table&&(k(V,["tbody"]),delete Ge.tbody),r.TRUSTED_TYPES_POLICY){if(typeof r.TRUSTED_TYPES_POLICY.createHTML!="function")throw Je('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof r.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Je('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');A=r.TRUSTED_TYPES_POLICY,I=A.createHTML("")}else A===void 0&&(A=Un(C,o)),A!==null&&typeof I=="string"&&(I=A.createHTML(""));ae&&ae(r),Le=r}},vr=k({},[...Gt,...Wt,...kn]),hr=k({},[...jt,...Rn]),ga=function(r){let s=M(r);(!s||!s.tagName)&&(s={namespaceURI:Ie,tagName:"template"});const g=vt(r.tagName),P=vt(s.tagName);return Rt[r.namespaceURI]?r.namespaceURI===st?s.namespaceURI===ve?g==="svg":s.namespaceURI===it?g==="svg"&&(P==="annotation-xml"||lt[P]):!!vr[g]:r.namespaceURI===it?s.namespaceURI===ve?g==="math":s.namespaceURI===st?g==="math"&&ct[P]:!!hr[g]:r.namespaceURI===ve?s.namespaceURI===st&&!ct[P]||s.namespaceURI===it&&!lt[P]?!1:!hr[g]&&(da[g]||!vr[g]):!!(je==="application/xhtml+xml"&&Rt[r.namespaceURI]):!1},me=function(r){qe(t.removed,{element:r});try{M(r).removeChild(r)}catch{p(r)}},we=function(r,s){try{qe(t.removed,{attribute:s.getAttributeNode(r),from:s})}catch{qe(t.removed,{attribute:null,from:s})}if(s.removeAttribute(r),r==="is")if(Oe||nt)try{me(s)}catch{}else try{s.setAttribute(r,"")}catch{}},_r=function(r){let s=null,g=null;if(xt)r="<remove></remove>"+r;else{const W=Bt(r,/^[\r\n\t ]+/);g=W&&W[0]}je==="application/xhtml+xml"&&Ie===ve&&(r='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+r+"</body></html>");const P=A?A.createHTML(r):r;if(Ie===ve)try{s=new O().parseFromString(P,je)}catch{}if(!s||!s.documentElement){s=H.createDocument(Ie,"template",null);try{s.documentElement.innerHTML=kt?I:P}catch{}}const Q=s.body||s.documentElement;return r&&g&&Q.insertBefore(a.createTextNode(g),Q.childNodes[0]||null),Ie===ve?F.call(s,Ae?"html":"body")[0]:Ae?s.documentElement:Q},yr=function(r){return J.call(r.ownerDocument||r,r,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT|m.SHOW_PROCESSING_INSTRUCTION|m.SHOW_CDATA_SECTION,null)},Dt=function(r){return r instanceof v&&(typeof r.nodeName!="string"||typeof r.textContent!="string"||typeof r.removeChild!="function"||!(r.attributes instanceof b)||typeof r.removeAttribute!="function"||typeof r.setAttribute!="function"||typeof r.namespaceURI!="string"||typeof r.insertBefore!="function"||typeof r.hasChildNodes!="function")},br=function(r){return typeof l=="function"&&r instanceof l};function he(h,r,s){ut(h,g=>{g.call(t,r,s,Le)})}const Tr=function(r){let s=null;if(he(B.beforeSanitizeElements,r,null),Dt(r))return me(r),!0;const g=j(r.nodeName);if(he(B.uponSanitizeElement,r,{tagName:g,allowedTags:V}),at&&r.hasChildNodes()&&!br(r.firstElementChild)&&ee(/<[/\w!]/g,r.innerHTML)&&ee(/<[/\w!]/g,r.textContent)||r.nodeType===Qe.progressingInstruction||at&&r.nodeType===Qe.comment&&ee(/<[/\w]/g,r.data))return me(r),!0;if(!(ke.tagCheck instanceof Function&&ke.tagCheck(g))&&(!V[g]||Ge[g])){if(!Ge[g]&&xr(g)&&(G.tagNameCheck instanceof RegExp&&ee(G.tagNameCheck,g)||G.tagNameCheck instanceof Function&&G.tagNameCheck(g)))return!1;if(At&&!ue[g]){const P=M(r)||r.parentNode,Q=D(r)||r.childNodes;if(Q&&P){const W=Q.length;for(let oe=W-1;oe>=0;--oe){const _e=_(Q[oe],!0);_e.__removalCount=(r.__removalCount||0)+1,P.insertBefore(_e,w(r))}}}return me(r),!0}return r instanceof d&&!ga(r)||(g==="noscript"||g==="noembed"||g==="noframes")&&ee(/<\/no(script|embed|frames)/i,r.innerHTML)?(me(r),!0):(Re&&r.nodeType===Qe.text&&(s=r.textContent,ut([Ee,S,T],P=>{s=Ke(s,P," ")}),r.textContent!==s&&(qe(t.removed,{element:r.cloneNode()}),r.textContent=s)),he(B.afterSanitizeElements,r,null),!1)},Er=function(r,s,g){if(dr&&(s==="id"||s==="name")&&(g in a||g in ma))return!1;if(!(Tt&&!bt[s]&&ee(L,s))){if(!(sr&&ee(X,s))){if(!(ke.attributeCheck instanceof Function&&ke.attributeCheck(s,r))){if(!q[s]||bt[s]){if(!(xr(r)&&(G.tagNameCheck instanceof RegExp&&ee(G.tagNameCheck,r)||G.tagNameCheck instanceof Function&&G.tagNameCheck(r))&&(G.attributeNameCheck instanceof RegExp&&ee(G.attributeNameCheck,s)||G.attributeNameCheck instanceof Function&&G.attributeNameCheck(s,r))||s==="is"&&G.allowCustomizedBuiltInElements&&(G.tagNameCheck instanceof RegExp&&ee(G.tagNameCheck,g)||G.tagNameCheck instanceof Function&&G.tagNameCheck(g))))return!1}else if(!St[s]){if(!ee(nr,Ke(g,Be,""))){if(!((s==="src"||s==="xlink:href"||s==="href")&&r!=="script"&&xn(g,"data:")===0&&ur[r])){if(!(lr&&!ee(xe,Ke(g,Be,"")))){if(g)return!1}}}}}}}return!0},xr=function(r){return r!=="annotation-xml"&&Bt(r,sa)},Ar=function(r){he(B.beforeSanitizeAttributes,r,null);const{attributes:s}=r;if(!s||Dt(r))return;const g={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:q,forceKeepAttr:void 0};let P=s.length;for(;P--;){const Q=s[P],{name:W,namespaceURI:oe,value:_e}=Q,Ce=j(W),It=_e;let K=W==="value"?It:An(It);if(g.attrName=Ce,g.attrValue=K,g.keepAttr=!0,g.forceKeepAttr=void 0,he(B.uponSanitizeAttribute,r,g),K=g.attrValue,fr&&(Ce==="id"||Ce==="name")&&(we(W,r),K=la+K),at&&ee(/((--!?|])>)|<\/(style|title|textarea)/i,K)){we(W,r);continue}if(Ce==="attributename"&&Bt(K,"href")){we(W,r);continue}if(g.forceKeepAttr)continue;if(!g.keepAttr){we(W,r);continue}if(!cr&&ee(/\/>/i,K)){we(W,r);continue}Re&&ut([Ee,S,T],Sr=>{K=Ke(K,Sr," ")});const wr=j(r.nodeName);if(!Er(wr,Ce,K)){we(W,r);continue}if(A&&typeof C=="object"&&typeof C.getAttributeType=="function"&&!oe)switch(C.getAttributeType(wr,Ce)){case"TrustedHTML":{K=A.createHTML(K);break}case"TrustedScriptURL":{K=A.createScriptURL(K);break}}if(K!==It)try{oe?r.setAttributeNS(oe,W,K):r.setAttribute(W,K),Dt(r)?me(r):Br(t.removed)}catch{we(W,r)}}he(B.afterSanitizeAttributes,r,null)},pa=function h(r){let s=null;const g=yr(r);for(he(B.beforeSanitizeShadowDOM,r,null);s=g.nextNode();)he(B.uponSanitizeShadowNode,s,null),Tr(s),Ar(s),s.content instanceof i&&h(s.content);he(B.afterSanitizeShadowDOM,r,null)};return t.sanitize=function(h){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=null,g=null,P=null,Q=null;if(kt=!h,kt&&(h="<!-->"),typeof h!="string"&&!br(h))if(typeof h.toString=="function"){if(h=h.toString(),typeof h!="string")throw Je("dirty is not a string, aborting")}else throw Je("toString is not a function");if(!t.isSupported)return h;if(Et||Ot(r),t.removed=[],typeof h=="string"&&(We=!1),We){if(h.nodeName){const _e=j(h.nodeName);if(!V[_e]||Ge[_e])throw Je("root node is forbidden and cannot be sanitized in-place")}}else if(h instanceof l)s=_r("<!---->"),g=s.ownerDocument.importNode(h,!0),g.nodeType===Qe.element&&g.nodeName==="BODY"||g.nodeName==="HTML"?s=g:s.appendChild(g);else{if(!Oe&&!Re&&!Ae&&h.indexOf("<")===-1)return A&&ot?A.createHTML(h):h;if(s=_r(h),!s)return Oe?null:ot?I:""}s&&xt&&me(s.firstChild);const W=yr(We?h:s);for(;P=W.nextNode();)Tr(P),Ar(P),P.content instanceof i&&pa(P.content);if(We)return h;if(Oe){if(nt)for(Q=z.call(s.ownerDocument);s.firstChild;)Q.appendChild(s.firstChild);else Q=s;return(q.shadowroot||q.shadowrootmode)&&(Q=Z.call(n,Q,!0)),Q}let oe=Ae?s.outerHTML:s.innerHTML;return Ae&&V["!doctype"]&&s.ownerDocument&&s.ownerDocument.doctype&&s.ownerDocument.doctype.name&&ee(oa,s.ownerDocument.doctype.name)&&(oe="<!DOCTYPE "+s.ownerDocument.doctype.name+`>
`+oe),Re&&ut([Ee,S,T],_e=>{oe=Ke(oe,_e," ")}),A&&ot?A.createHTML(oe):oe},t.setConfig=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ot(h),Et=!0},t.clearConfig=function(){Le=null,Et=!1},t.isValidAttribute=function(h,r,s){Le||Ot({});const g=j(h),P=j(r);return Er(g,P,s)},t.addHook=function(h,r){typeof r=="function"&&qe(B[h],r)},t.removeHook=function(h,r){if(r!==void 0){const s=Tn(B[h],r);return s===-1?void 0:En(B[h],s,1)[0]}return Br(B[h])},t.removeHooks=function(h){B[h]=[]},t.removeAllHooks=function(){B=Xr()},t}var Hn=ia(),zn=U('<button class="mb-3 flex items-center gap-1 text-sm text-gray-500 hover:text-gray-700 lg:hidden dark:text-gray-400 dark:hover:text-gray-200"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg> Back</button>'),Bn=U("<span> </span>"),Gn=U('<button class="rounded-md bg-gray-100 px-3 py-1 text-xs text-gray-600 dark:bg-gray-800 dark:text-gray-400">Mark unread</button>'),Wn=U("<p> </p>"),jn=U('<article class="h-full overflow-y-auto p-6"><header class="mb-4"><!> <h2 class="text-2xl font-bold text-gray-900 dark:text-white"> </h2> <div class="mt-2 flex items-center gap-3 text-sm text-gray-500 dark:text-gray-400"><!> <span> </span> <a target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline dark:text-indigo-400">Open original</a></div> <div class="mt-3 flex gap-2"><button> </button> <!></div></header> <div class="prose prose-sm max-w-none dark:prose-invert"><!></div></article>'),Yn=U('<div class="flex h-full items-center justify-center"><p class="text-gray-400 dark:text-gray-500">Select an entry to read.</p></div>');function Vn(e,t){He(t,!0);let a=Pe(()=>{var l;return(l=t.entry)!=null&&l.content?Hn.sanitize(t.entry.content):""});var n=Vt(),o=Jt(n);{var i=l=>{var d=jn(),m=E(d),b=E(m);{var v=T=>{var L=zn();L.__click=function(...X){var xe;(xe=t.onBack)==null||xe.apply(this,X)},N(T,L)};re(b,T=>{t.onBack&&T(v)})}var O=R(b,2),C=E(O,!0);x(O);var u=R(O,2),_=E(u);{var p=T=>{var L=Bn(),X=E(L,!0);x(L),ce(()=>se(X,t.entry.author)),N(T,L)};re(_,T=>{t.entry.author&&T(p)})}var w=R(_,2),D=E(w,!0);x(w);var M=R(w,2);x(u);var A=R(u,2),I=E(A);I.__click=()=>pe.toggleSaved(t.entry.id,$.accessToken);var H=E(I,!0);x(I);var J=R(I,2);{var z=T=>{var L=Gn();L.__click=()=>pe.markUnread(t.entry.id,$.accessToken),N(T,L)},F=Pe(()=>pe.isRead(t.entry.id));re(J,T=>{c(F)&&T(z)})}x(A),x(m);var Z=R(m,2),B=E(Z);{var Ee=T=>{var L=Vt(),X=Jt(L);$a(X,()=>c(a)),N(T,L)},S=T=>{var L=Wn(),X=E(L,!0);x(L),ce(()=>se(X,t.entry.summary)),N(T,L)};re(B,T=>{c(a)?T(Ee):T(S,!1)})}x(Z),x(d),ce((T,L,X)=>{se(C,t.entry.title),se(D,T),Qt(M,"href",t.entry.url),Te(I,1,`rounded-md px-3 py-1 text-xs ${L??""}`),se(H,X)},[()=>new Date(t.entry.published).toLocaleDateString(),()=>pe.isSaved(t.entry.id)?"bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200":"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400",()=>pe.isSaved(t.entry.id)?"Saved":"Save"]),N(l,d)},f=l=>{var d=Yn();N(l,d)};re(o,l=>{t.entry?l(i):l(f,!1)})}N(e,n),ze()}rt(["click"]);var Xn=qr('<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>'),qn=qr('<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>'),Kn=U('<button class="rounded-md bg-gray-100 px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700">Sign out</button>'),Jn=U('<button class="rounded-md bg-indigo-600 px-3 py-1.5 text-sm text-white hover:bg-indigo-700">Sign in with Google</button>'),Zn=U('<header class="flex items-center justify-between border-b border-gray-200 bg-white px-4 py-3 dark:border-gray-700 dark:bg-gray-900"><div class="flex items-center gap-3"><button class="rounded p-1 text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800 lg:hidden" aria-label="Toggle sidebar"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button> <h1 class="text-xl font-bold text-gray-900 dark:text-white">Readly</h1></div> <div class="flex items-center gap-2"><button class="rounded p-1.5 text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800" aria-label="Toggle dark mode"><!></button> <!></div></header>');function Qn(e,t){He(t,!0);let a=Y(!1);ea(()=>{y(a,localStorage.getItem("theme")==="dark"||!localStorage.getItem("theme")&&window.matchMedia("(prefers-color-scheme: dark)").matches,!0),n()});function n(){document.documentElement.classList.toggle("dark",c(a))}function o(){y(a,!c(a)),localStorage.setItem("theme",c(a)?"dark":"light"),n()}var i=Zn(),f=E(i),l=E(f);l.__click=function(...p){var w;(w=t.onToggleSidebar)==null||w.apply(this,p)},qa(2),x(f);var d=R(f,2),m=E(d);m.__click=o;var b=E(m);{var v=p=>{var w=Xn();N(p,w)},O=p=>{var w=qn();N(p,w)};re(b,p=>{c(a)?p(v):p(O,!1)})}x(m);var C=R(m,2);{var u=p=>{var w=Kn();w.__click=()=>$.signOut(),N(p,w)},_=p=>{var w=Jn();w.__click=()=>$.signIn(),N(p,w)};re(C,p=>{$.isSignedIn?p(u):p(_,!1)})}x(d),x(i),N(e,i),ze()}rt(["click"]);var $n=U('<div class="group flex items-center"><button> <span class="ml-1 text-xs text-gray-400 dark:text-gray-500"> </span></button> <button class="ml-1 hidden rounded p-1 text-gray-400 hover:text-red-500 group-hover:block dark:hover:text-red-400" aria-label="Remove feed"><svg class="h-3.5 w-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div>'),eo=U('<p class="px-3 py-2 text-sm text-gray-400 dark:text-gray-500">No feeds yet. <button class="text-indigo-500 hover:underline">Add one</button></p>'),to=U('<nav class="flex h-full flex-col overflow-y-auto border-r border-gray-200 bg-gray-50 dark:border-gray-700 dark:bg-gray-900"><div class="p-3"><button>All feeds</button></div> <div class="flex-1 px-3 pb-3"><div class="mb-1 flex items-center justify-between px-3"><h2 class="text-xs font-semibold uppercase tracking-wider text-gray-500 dark:text-gray-400">Subscriptions</h2> <button class="rounded p-0.5 text-gray-400 hover:bg-gray-200 hover:text-gray-600 dark:hover:bg-gray-700 dark:hover:text-gray-300" aria-label="Add feed"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg></button></div> <!> <!></div> <div class="border-t border-gray-200 px-3 py-2 dark:border-gray-700"><div class="flex gap-2"><button class="flex-1 rounded-md px-2 py-1.5 text-xs text-gray-500 hover:bg-gray-200 dark:text-gray-400 dark:hover:bg-gray-800">Import OPML</button> <button class="flex-1 rounded-md px-2 py-1.5 text-xs text-gray-500 hover:bg-gray-200 dark:text-gray-400 dark:hover:bg-gray-800">Export OPML</button></div></div></nav>');function ro(e,t){He(t,!0);var a=to(),n=E(a),o=E(n);o.__click=function(..._){var p;(p=t.onSelectAll)==null||p.apply(this,_)},x(n);var i=R(n,2),f=E(i),l=R(E(f),2);l.__click=function(..._){var p;(p=t.onAddFeed)==null||p.apply(this,_)},x(f);var d=R(f,2);ta(d,17,()=>t.feeds,_=>_.url,(_,p)=>{var w=$n(),D=E(w);D.__click=()=>t.onSelectFeed(c(p).url);var M=E(D),A=R(M),I=E(A,!0);x(A),x(D);var H=R(D,2);H.__click=()=>t.onRemoveFeed(c(p).url),x(w),ce(()=>{Te(D,1,`flex-1 truncate rounded-md px-3 py-1.5 text-left text-sm ${t.selectedFeedUrl===c(p).url?"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200":"text-gray-600 hover:bg-gray-200 dark:text-gray-400 dark:hover:bg-gray-800"}`),se(M,`${c(p).title??""} `),se(I,c(p).entries.length)}),N(_,w)});var m=R(d,2);{var b=_=>{var p=eo(),w=R(E(p));w.__click=function(...D){var M;(M=t.onAddFeed)==null||M.apply(this,D)},x(p),N(_,p)};re(m,_=>{t.feeds.length===0&&_(b)})}x(i);var v=R(i,2),O=E(v),C=E(O);C.__click=function(..._){var p;(p=t.onImportOpml)==null||p.apply(this,_)};var u=R(C,2);u.__click=function(..._){var p;(p=t.onExportOpml)==null||p.apply(this,_)},x(O),x(v),x(a),ce(()=>Te(o,1,`w-full rounded-md px-3 py-2 text-left text-sm font-medium ${t.selectedFeedUrl===null?"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200":"text-gray-700 hover:bg-gray-200 dark:text-gray-300 dark:hover:bg-gray-800"}`)),N(e,a),ze()}rt(["click"]);function ao(e){const n=new DOMParser().parseFromString(e,"text/xml").querySelectorAll("outline[xmlUrl]"),o=[];return n.forEach(i=>{var m;const f=i.getAttribute("xmlUrl");if(!f)return;const l=i.getAttribute("title")||i.getAttribute("text")||f,d=((m=i.parentElement)==null?void 0:m.getAttribute("text"))??"";o.push({url:f,title:l,folder:d,added:new Date().toISOString()})}),o}function no(e){const t=new Map;for(const n of e){const o=n.folder||"";t.has(o)||t.set(o,[]),t.get(o).push(n)}let a="";for(const[n,o]of t){const i=o.map(f=>`      <outline type="rss" text="${gt(f.title)}" title="${gt(f.title)}" xmlUrl="${gt(f.url)}" />`).join(`
`);n?a+=`    <outline text="${gt(n)}">
${i}
    </outline>
`:a+=i+`
`}return`<?xml version="1.0" encoding="UTF-8"?>
<opml version="2.0">
  <head>
    <title>Readly Subscriptions</title>
    <dateCreated>${new Date().toUTCString()}</dateCreated>
  </head>
  <body>
${a}  </body>
</opml>`}function gt(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}var oo=U('<div class="fixed bottom-4 left-4 right-4 rounded-md bg-amber-600 px-4 py-3 text-sm text-white shadow-lg sm:left-auto sm:max-w-md"> </div>'),io=U('<div class="fixed bottom-4 right-4 rounded-md bg-indigo-600 px-3 py-1.5 text-sm text-white shadow-lg">Loading feeds...</div>'),so=U('<div class="fixed bottom-4 right-4 rounded-md bg-red-600 px-3 py-1.5 text-sm text-white shadow-lg"> </div>'),lo=U('<div class="flex h-screen flex-col bg-white dark:bg-gray-950"><!> <div class="flex flex-1 overflow-hidden"><div><!></div> <div><!></div> <div><!></div></div> <!> <!> <!> <!></div>');function go(e,t){He(t,!0);let a=Y(!1),n=Y(null),o=Y(null),i=Y(!1),f=Y("list"),l=Pe(()=>{var S,T;return c(n)?((T=(S=Se.bundle)==null?void 0:S.feeds[c(n)])==null?void 0:T.entries)??[]:Se.allEntries});ea(()=>{$.handleRedirect(),Se.loadBundle(),$.isSignedIn&&$.accessToken&&(pe.loadFromDrive($.accessToken),et.loadFromDrive($.accessToken))});function d(S){y(o,S,!0),y(f,"entry"),pe.markRead(S.id,$.accessToken)}function m(){y(o,null),y(f,"list")}async function b(S){await et.removeFeed(S,$.accessToken),c(n)===S&&(y(n,null),y(o,null))}function v(){const S=document.createElement("input");S.type="file",S.accept=".opml,.xml",S.onchange=async()=>{var xe;const T=(xe=S.files)==null?void 0:xe[0];if(!T)return;const L=await T.text(),X=ao(L);for(const Be of X)await et.addFeed(Be.url,Be.title,$.accessToken)},S.click()}function O(){const S=no(et.feeds),T=new Blob([S],{type:"text/xml"}),L=URL.createObjectURL(T),X=document.createElement("a");X.href=L,X.download="readly-subscriptions.opml",X.click(),URL.revokeObjectURL(L)}var C=lo(),u=E(C);Qn(u,{onToggleSidebar:()=>y(a,!c(a))});var _=R(u,2),p=E(_),w=E(p);ro(w,{get feeds(){return Se.feeds},get selectedFeedUrl(){return c(n)},onSelectFeed:S=>{y(n,S,!0),y(o,null),y(f,"list"),y(a,!1)},onSelectAll:()=>{y(n,null),y(o,null),y(f,"list"),y(a,!1)},onAddFeed:()=>y(i,!0),onRemoveFeed:b,onImportOpml:v,onExportOpml:O}),x(p);var D=R(p,2),M=E(D);{let S=Pe(()=>{var T;return((T=c(o))==null?void 0:T.id)??null});hn(M,{get entries(){return c(l)},get selectedEntryId(){return c(S)},onSelectEntry:d})}x(D);var A=R(D,2),I=E(A);Vn(I,{get entry(){return c(o)},onBack:m}),x(A),x(_);var H=R(_,2);{var J=S=>{var T=oo(),L=E(T,!0);x(T),ce(()=>se(L,$.authError)),N(S,T)};re(H,S=>{$.authError&&S(J)})}var z=R(H,2);{var F=S=>{var T=io();N(S,T)};re(z,S=>{Se.loadingState==="loading"&&S(F)})}var Z=R(z,2);{var B=S=>{var T=so(),L=E(T,!0);x(T),ce(()=>se(L,Se.error)),N(S,T)};re(Z,S=>{Se.loadingState==="error"&&S(B)})}var Ee=R(Z,2);un(Ee,{get open(){return c(i)},onClose:()=>y(i,!1)}),x(C),ce(()=>{Te(p,1,`w-64 shrink-0 ${c(a)?"block":"hidden"} lg:block`),Te(D,1,`w-full shrink-0 lg:w-80 ${c(f)==="entry"?"hidden lg:block":"block"}`),Te(A,1,`flex-1 ${c(f)==="list"?"hidden lg:block":"block"}`)}),N(e,C),ze()}export{go as component};
